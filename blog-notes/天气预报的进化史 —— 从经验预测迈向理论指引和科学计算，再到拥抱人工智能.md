---
completed: true
---
Site: https://www.metax-tech.com/ndetail/12503.html
Date: 07 June 2024

## 摘要
人类生活在地表之上大气之中，天气的变化深刻地影响着人类的生产生活，因而天气预报一直深受关注。早期的天气预报纯粹依靠生活经验判断，随着气象观测仪器的发明和观测网的逐步建立，天气图成为天气预报的主要工具，基于天气图的外推预报虽然准确率大为提升，但仍然很大程度上取决于预报员的经验。数值预报是基于数学物理学方法客观定量计算未来天气演变的预报技术，电子计算机的发展促成了第一个数值天气预报的成功实施，使得天气预报转变成为客观定量的科学。作为气象业务的核心科技，数值预报被誉为气象领域的“芯片”，其发展依赖于高性能计算机和并行技术的支撑。目前数值预报模式朝着更高分辨率、更复杂物理过程、集合预报、多模式耦合的方向发展，所需的计算资源也在与日俱增，GPU 的出现和异构并行技术的发展为缓解这一矛盾提供了一条有效途径。近年来，随着人工智能的快速发展，**AI 与气象科学结合诞生出了一种新型的预报方法——AI 气象大模型，其本质是利用 GPU 高算力和深度学习技术对海量历史气象数据进行学习和建模，以提升预报的准确性和效率。这些模型的预报效果在某些方面接近甚至超过了数值天气预报，表现出强大的发展潜力**。

>  天气预报: 依靠生活经验 -> 基于天气图的外推预报 -> 基于数学物理方法的数值预报 -> AI 气象大模型

风雨雷电，云雾霜雪，大自然多姿多彩的天气现象，展现出奇妙的变化与无穷的魅力。天气，或称气象，不仅关乎我们日常的衣食住行，还对农业、交通、能源和环保等重要领域的生产活动产生深远的影响，因此，准确的天气预报一直是人们孜孜以求的目标。然而，制约天气变化的因素众多，大气系统内部除了包含极其复杂的动力和热力过程，也包含形成雨雪、云雾和雷电等自然现象的物理过程。同时，大气系统的演化还受到地形、海洋条件、人类活动等多种因素的影响，这些因素的复杂性和不确定性使得预测未来天气变得极为困难。**本文对天气预报的发展历程进行了系统梳理，带大家一起了解天气预报的前世今生，特别是 GPU 在当今天气预报中起到的重要作用**。

![](https://www.metax-tech.com/uploads/image/20240607/20240607091926_61187.png)

图 1 气候系统各组成部分和相互影响的示意图  
来源：https://archive.ipcc.ch/publications_and_data/ar4/wg1/zh/faq-1-2.html

## 1. 早期的天气预报
人类对天气的探索由来已久，早在三千多年前，我国殷代甲骨文中就已有表达风、云、虹、雨、雪等大气现象的文字记载。自殷商时期开始，人们就非常重视天气变化对人类活动的影响，重大活动如祭祀、农业生产、战争等都需要提前预知天气。在当时的认知水平下，出于对大自然的敬畏，气象预报往往和占卜、求雨等迷信活动有关，缺乏科学依据。

![](https://www.metax-tech.com/uploads/image/20240607/20240607092055_65195.jpeg)

图 2 甲骨文记载天气现象的文字  
来源：中国气象局

在长期的生产实践中，古人通过观察天空、天气现象和动植物的行为来记录和预报天气，逐渐积累了对大气现象的认识和经验。流传至今的天气谚语就体现了早期人们对天气预报的关注，这些谚语经反复总结印证而得到，具有一定的可信度。中国古代以农耕为主，非常重视对天象及其节气的观测，二十四节气是古代劳动人民根据对自然和气候变化的观察所形成的知识体系，它不仅反映了季节的变化，还包含了对天气、物候和农业活动规律的深刻理解，对指导农业生产具有重要意义。

可以说，早期的天气预报更多凭借的是长期观测天气和气候得出的经验性总结，其结论通常是定性的和局地的，可靠度较低。

>  早期: 天气谚语，来自于经验性总结

## 2. 现代天气预报
16-18 世纪，伴随着航海业的发达以及工业革命的发展，各种定量测量的气象观测仪器陆续被发明。如 1593 年前后伽利略发明了温度表，1643 年托里拆利发现了气压表原理，气象观测逐渐开始进入大发展时期。与此同时，数学、物理等基础学科也快速发展，为气象学的发展奠定了坚实的理论基础。

1816 年，德国气象学家布兰德斯将 1783 年各地的气压和风的同期观测记录填入地图，绘制了世界上第一张天气图。1851 年，英国人格莱舍在英国皇家博览会上展出第一张利用电报收集各地气象资料而绘制的可供实际应用的瞬时天气图。天气图的出现在气象学上意义重大，它把很多个站点的气象要素有机地联系到了一起，使我们的眼界由点扩展到面。

>  天气图: 各地的气压和风的同期观测记录

![](https://www.metax-tech.com/uploads/image/20240607/20240607092147_66246.jpg)

图 3 布兰德斯的第一张天气图  
来源：https://www.sciencedirect.com/topics/earth-and-planetary-sciences/synoptic-meteorology

1854 年 11 月，历史上著名的克里米亚战争正在激烈进行，英法联军包围了塞瓦斯托波尔，陆战队准备在黑海的巴拉克拉瓦港登陆，形势非常有利。不料黑海上突然风暴降临，英法联军损失惨重，几乎全军覆没。事后，法国巴黎天文台长勒佛里埃受命调查这次风暴的来龙去脉。他向各国气象学家征集风暴发生前后的气象报告，收集后依次把同一时间各地的气象情况填在一张图上，经仔细分析后发现，这次风暴是自西向东移动的，当其到达黑海的前 1 至 2 天，西班牙和法国已先受其影响。也就是说，如果当时注意到这一现象，这场灾难是可以避免的。

此后，勒佛里埃创议由政府组织气象观测网，并将观测资料集中起来进行分析，绘制天气图。1856 年，法国建立了世界上第一个气象站网，开展天气预报服务。从此绘制天气图便成为一项日常业务，并陆续推广到其他国家。

普遍认为，现代天气预报开始于天气图的诞生，预报人员可以在短时间内通过天气图了解一定范围内乃至全球的气象情况，通过连续的几张天气图，结合天气系统的运动规律，也可推测天气的未来变化。虽然预报仍然与经验和个人的主观判断密切相关，但是基于天气图出发的分析手段使天气预报技巧大大提升。

>  通过连续的天气图，结合天气系统的运动规律，推测天气的未来变化

## 3. 数值天气预报
天气图并没有解决定量的天气预报问题，它仅定量地反映了刚刚过去的天气。根据天气系统的过去演变以及理论模型，也可以外推和估计未来可能的天气形势和气象要素的变化，但由于这种方法并未反映大气内部的运动变化规律，其预报水平受到很大的限制。因此，研究天气演变的物理规律，发展建立在定量描述基础上的预报技术是十分必要的。

>  天气图仅仅是定性外推
>  数值天气预报: 定量演算

### 3.1 数值天气预报的诞生
科学的发展让人们逐渐认识到大气也是一种流体，它的运动轨迹遵循流体力学的基本理论。1904 年，挪威气象学家皮叶克尼斯（Vilhelm Bjerknes）在世界上首次提出了天气预报问题是对大气运动方程进行积分求解的概念，他认为大气的未来状态原则上完全由大气的初始状态、已知的边界条件和大气运动方程、质量守恒方程、状态方程和热力学方程所共同决定，这就是数值天气预报思想的起源。这些方程构成了一组复杂的非线性偏微分方程式组，难以求解。

>  大气也是流体，其运动遵循流体力学的基本理论
>  数值天气预报思想: 天气预报问题是对大气运动方程求解，大气的未来状态原则上完全由大气的初始状态、已知的边界条件、大气运动方程、质量守恒方程、状态方程、热力学方程所共同决定
>  这些方程组成了复杂的非线性偏微分方程组

直至数值天气预报的思想提出将近二十年后，英国数学家和物理学家理查德森（Lewis Fry Richardson）才第一个大胆地尝试用数值积分这些方程的方法求解天气预报问题：取未经简化的完全原始方程，将欧洲区域分成若干网格，水平格距 200 公里，垂直 4 层（层顶 200 hPa），中心位于德国，1910 年 5 月 20 日 07 时的观测作为初值，用有限差分来近似微分，用求和来近似积分。在没有计算机的时代，只能人工用纸笔计算这些十分复杂的公式，借助一把计算尺，理查德森制作出了世界上第一张 6 小时地表气压数值预报图。预报的地表气压变化为 146 hPa，而实况几乎没有变化，从精度上看，该预报毫无参考价值, 并且其计算时间花了 6 个星期, 从时效上也已毫无预报意义。

>  用数值积分方法求解该方程组: 网格化预报区域、取过去观测作为初值、用有限差分近似微分、用求和近似积分

尽管如此，他还是推测：“In the dim future it will be possible to advance the computations faster than the weather advances”。基于他的预报模型的巨大计算需求，理查德森提出了“天气预报工厂”的设想，在这个工厂里，通过彩色信号灯和电报通信来指挥和协调 64000 名专业计算人员（computer，非现在所指的计算机）同时用手工进行必要的计算，才能做出时效上有意义的预报（理查德森和“天气预报工厂”在过去的智算芯闻“[**GPU频借力，CFD上青云**](https://www.metax-tech.com/ndetail/12361.html)”中已经有过介绍）。显然，他的设想是一个理想的乌托邦，让量化的天气预报从理论走进现实，还得等待真正意义上的计算机的出现。

20 世纪 30 年代末，随着高空观测网的建立，在大量观测资料基础上，罗斯贝提出了著名的长波理论，大气动力学也得到了进一步发展。同时，第一台电子计算机 ENIAC 的问世，为解决这一问题提供了可能。1950 年，在普林斯顿高级研究所，气象学家恰尼、费也托夫等人和计算机之父冯·诺依曼合作，在 ENIAC 上成功地制作出了历史上第一个 24 小时天气预报图。他们对理查德森用到的原始方程模式进行了简化，利用大尺度大气运动的准地转平衡特性滤去快变的重力波和声波，建立了正压模式，并采用差分方法数值求解。正压模式是单层模式，因为正压大气中等压面上的温度是均匀的，没有温度变量，所有等压面的形势都相同，所以只需要用 500 hPa 一个等压面就可以代表整个大气层。预报结果清楚地表明，大气的大尺度特征与实际情况相当接近。因为强调计算方法和电子计算机的作用，“数值天气预报”一词才被正式确定，其名称掩盖了天气预报的流体力学方法，尽管后者更能反映天气系统的物理本质。

![](https://www.metax-tech.com/uploads/image/20240607/20240607092256_24312.png)

图 4 第一个成功的 24 小时数值天气预报 a. t = 0 的位势高度和涡度实况b. t = 24h 的位势高度和涡度实况 c. 位势高度和涡度实况 24h 的变化 d. t = 24h 的位势高度和涡度预报  
来源：Charney J G, Fjörtoft R and von Neumann J. Numerical Integration of the Barotropic Vorticity Equation. Tellus A: Dynamic Meteorology and Oceanography, 1950

1954 年，瑞典和美国先后开启业务数值天气预报，数值天气预报从纯研究探索走向了业务应用。随后，其它国家陆续跟进。到 20 世纪 70 年代初期，数值天气预报已被较为普遍地应用于实际业务中。现在，几乎所有国家的气象部门都设有专门的数值天气预报中心，根据不同的预报对象，如全球中期天气预报、区域短期天气预报、台风预报等，分别建立了不同的数值预报业务。其中，广为人知的包括欧洲中期天气预报中心（ECMWF，简称 EC）的综合预报系统 IFS 和美国大气海洋管理局 (NOAA) 开发的全球预报系统 GFS。

中国是气象数值预报起步较早的国家之一, 早在上世纪 50~60 年代初, 中国第一代数值预报专家就开始了数值预报模式及相关计算方法的研究，并建立了试验预报系统。1980 年国家气象中心利用自行研制的亚欧区域短期预报模式开始发布日常 48 小时形势预报，中国气象数值预报进入业务实用阶段。1999 年，我国业务数值天气预报走上自主研发之路，开启全球区域同化预报系统（GRAPES）研发。2016 年，GRAPES 正式业务化运行并面向全国下发预报产品。

经过 70 年的发展，数值预报已经成为一个跨学科的复杂而严格的系统性工程，使得天气预报从传统的以统计和经验为主的天气图方法，转变成为客观定量的科学。数值预报被认为是物理学科各领域中最具影响的成就之一。

### 3.2 数值预报面临的算力挑战
业务可用的数值模式远比首个成功的数值预报使用的正压模式复杂，因为正压模式仅能描述大尺度天气系统，而被滤去的重力波常造成局部地区的剧烈天气现象，故用正压模式做出的数值预报只能达到可供天气预报员参考的水平。要使数值天气预报变成主要的预报依据，必须回归原始方程模式。

然而，原始方程模式还只是为天气预报提供了较好的“动力框架”，距离预报天气现象还相差很远。在中高纬度带，大气的演变过程主要由流场自身的斜压性和绝热动力过程所致，降水等非绝热过程是第二位的。而在热带和中低纬度带，水汽相变过程是大气运动极其重要的能量来源。所以，水汽相变、辐射能吸收和传输以及边界层的作用等物理过程，都必须在模式中加以考虑。

>  在方程模式中，还需要考虑水汽相变、辐射能吸收和传输以及边界层的作用等物理过程

模式中的动力框架与物理过程可用下式简单地表示：


![](https://www.metax-tech.com/uploads/image/20240607/20240607092331_58442.png)

  

其中 $\psi$ 为模式预报量，主要包含温度、风、比湿等，$D$ 代表动力框架部分产生的倾向，$P$ 代表物理过程产生的倾向。模式中的动力框架部分即是计算上式中的 $D(\psi)$ ，而物理过程部分则是计算 $P(\psi)$，此外物理过程部分还计算一些诊断量，如降水、辐射通量等。动力框架部分和物理过程部分计算得到的倾向相加即得到预报量总的倾向，用以对预报量进行积分。模式方程通常在准规则的三维空间格点上进行求解。

>  可以用上述简单方程描述所有的模式
>  上述方程表明，模式预报量 $\psi$ 随时间的变化率 $\frac {\partial \psi}{\partial t}$ 可以被描述为两个变化倾向的叠加作用:
>  - $D(\psi)$，动力框架部分产生的倾向
>  - $P(\psi)$，物理过程部分产生的倾向
>  通过求解这两部分倾向，近似预报量的变化率，再对时间 (近似) 积分，就可以求解预报量

![](https://www.metax-tech.com/uploads/image/20240607/20240607092347_31984.png)

图 5 数值预报模式结构示意图 
来源：//celebrating200years. noaa.gov/breakthroughs/climate_model/modeling_schematic. html
  
原始方程模式包含了长波和重力波（快波），为使计算稳定，更好地刻画大尺度运动的变化，回归原始方程的要点在于避免重力波的虚假产生和增长。第一，要对初值场进行处理，必须抑制初值中重力波的能量及其在初始时段的增长；第二，一般情况下积分的时间步长必须取足够小，以满足数组计算稳定性（即 CFL 条件，$U\Delta t/\Delta x \le 1$），否则会出现计算暴死（computational blow-up），这也是理查德森的数值试验失败的主要原因。

CFL 条件表明，在进行线性计算时，为使计算稳定，差分计算的时间步长必须小于波动通过空间网格距所需要的时间。对于慢波，如大气长波，波速较小，时间步长可以取得大一些；而对于快波，如声波、重力波，波速快，则时间步长只能取得很短，因此要完成一个预报，要做更多步的计算。

>  要确保计算稳定，差分计算的时间步长越小越好，要求必须小于波动通过空间网格距所需要的时间 (否则波动还没传播过去就差分计算的话，就得到错误的结果)

大气中存在各种尺度的天气系统，水平尺度从次公里到几千甚至上万公里不等，为了描述不同尺度的天气系统，网格距就要足够小，即分辨率要尽量高。理论上说，模式分辨率越高，大气控制方程的数值解也越接近解析解。

>  网格距越小，分辨率就越高，当然 (近似) 数值解就越接近解析解

![](https://www.metax-tech.com/uploads/image/20240607/20240607092409_28184.png)

图 6 天气系统的特征尺度  
来源：百度百科

简单来说，提高预报的准确率要求模式具有较高空间分辨率，而为了保证计算的稳定性，时间步长又要取得足够小，两种因素叠加，计算量就非常可观了。一般情况下，模式分辨率每提高 1 倍，与空间相关的计算量将提高至 8 倍，时间积分步长减半导致积分步数增加 1 倍，总的计算量将增至 16 倍。在全球模式水平分辨率取 5 公里，垂直方向 60 层的情况下，模式网格数量将达到 40 亿个。

>  为了接近解析解，需要将网格距取得足够小，这也进而要求时间步要足够小

为数值模式提供初始场的过程称之为资料同化，它综合利用气象观测资料（如常规气象资料、雷达资料、卫星资料等）、背景场及误差统计等先验知识，通过一系列的处理，以得到一个最优的初始条件。随着各种资料量的增多，资料同化也需要付出很大的计算代价。

此外，大气系统是一个极其复杂的非线性系统，其混沌特征决定了对预报初始条件非常敏感，初始场微小的变化可以引起完全不同的天气发展结果，实际业务中通常采用集合预报来解决单一预报的不确定性。它通过对初始场引入微小扰动，执行多次预报从而产生一系列可能的预报结果，使之能包含实际天气的发展情况，其预报效果从概率上好于单个预报，但随之而来的是多次预报带来的计算量的线性增加。

>  集合预报: 输入多个被微小扰动的初始场，执行多次预报，产生一系列可能预报结果，显然在概率上，猜中真实预报的概率就会更高
>  但计算代价也线性增长

![](https://www.metax-tech.com/uploads/image/20240607/20240607092432_89261.png)

图 7 集合预报示意图  
来源：Bauer P, Thorpe A, Brunet G. The quiet revolution of numerical weather prediction. Nature, 2015

因此数值天气预报拥有巨大的计算量，而天气预报业务对时效性要求很高，必须在一定时间内完成，否则预报没有意义。制作未来 10 天的全球数值预报，通常需在超过 3000 个节点的超级计算机上花费数小时时间。

数值天气预报的原理也可以应用到气候的预测和预估上，也就是气候模式，传统的气候模式主要包含大气、海洋、陆地和海冰等分量模式。更进一步，在气候模式的基础上扩展大气化学、生物地球化学和人类活动影响等过程以及以上过程之间的相互作用，构成了地球系统模式，这对计算资源的要求更高。

>  数值天气预报的原理泛用于各个气候模式预测和评估，包括大气、海洋、陆地等

数值预报从诞生之日起，就与科学计算结下了不解之缘。科学计算技术的进步在数值预报的应用发展上占有极其关键的作用，几乎在任一时期，数值天气预报系统都使用了当时最快速的高性能计算机。以我们国家为例，20 世纪 90 年代以来，中国气象局先后引进了银河Ⅱ、CRAY J90、CRAY EL98、CRAY C92、IBM SP、IBM SP2、曙光 1000A、派-曙光……等一系列高性能计算机，支撑数值预报模式的高速发展需求。

不断提高预报的准确率是社会发展的必然要求，数值模式正朝着更高时空分辨率、更复杂物理过程、集合预报和多模式耦合发展。主要发达国家和中国都正在致力于研发各自的新业务数值预报模式——非静力（多尺度）一体化模式或非静力中尺度模式，部分国家的新一代天气-气候一体化数值模式已业务运行。2021 年，中国气象局国家级业务数值预报体系基本配置如下图所示。

![](https://www.metax-tech.com/uploads/image/20240607/20240607092502_30012.png)

图 8 2021 年国家级业务数值预报体系基本配置  
来源：中国气象局

EC 全球确定性模式和集合模式已统一至水平分辨率为 9 公里，NextGEMS 项目正在推动公里级地球系统模型的发展。NOAA 计划其全球确定性预报系统 GFS 水平分辨率 2027 年达到 3 公里。中国气象局目前全球模式水平分辨率已经达到 12.5 公里，区域模式分辨率达 3 公里，规划 2027 年下一代全球模式水平分辨率提升到 5 公里，区域模式提升到 1 公里、局地次公里。这些新的预报模式将给计算资源带来巨大的挑战。

### 3.3 数值预报与 GPU 加速
数值模式发展的同时，科学计算领域也在发生着深刻的变化。作为计算机的核心——CPU 的体系结构经历了从单核、多核到众核的革命性跨越。如今，“异构+众核”已成为超级计算机主流的体系结构，世界领先的超级计算机都装备大量的 GPU 或者众核处理器。特别是作为加速部件的 GPU，表现出出色的浮点计算能力、低能耗和高性价比，被越来越多地应用于科学计算领域。因此，**很多研究和业务单位开始转向用 GPU 来加速数值预报模式**。

2016 年，瑞士联邦气象局 MeteoSwiss 成为首个利用 GPU 加速的模式（COSMO）进行业务预报的国家级气象单位。COSMO 模式包含大约 30 万行 Fortran 90 代码，其中动力核心 4 万行代码，利用 Domain Specific Language (DSL) 改写，通过创建 C++和 CUDA 后端来加速，物理过程参数化 13 万行代码，使用了 OpenACC 方式移植。强大的新系统将 24 小时天气预报模型分辨率从 2.2 公里提升到 1.1 公里，让 MeteoSwiss 能更精准地预测降水和降雪的量级、时间和落区，对重大天气提供早期警报。同时将中期天气预报的分辨率提升 3 倍，且将预报时长从 3 天扩大到 5 天。

>  算力增强了，就可以进一步细化分辨率和时间步，进而提高预报精度

![](https://www.metax-tech.com/uploads/image/20240607/20240607092532_51989.png)

图 9 COSMO 模式 GPU 加速流程图  
来源：https://events.ecmwf.int/event/169/contributions/2767/attachments/1460/2636/HPC-WS_Lapillonne.pdf

2019 年 11 月，IBM 公司宣布将推出一项全新的全球天气预报系统，名为 GRAF。GRAF 是首个基于 GPU 运行的全球气象模式，其框架来源于美国国家大气科学研究中心（NCAR）和洛斯阿拉莫斯国家实验室 (LANL) 联合开发的 MPAS 模式，IBM 采用 OpenACC 加速技术完成了后期模式在 GPU 上的移植。GRAF 能够提前 12 小时预测天气状况，其空间分辨率高达 3 公里，且每小时进行更新，而当前的全球天气预报系统模式通常是每 6-12 小时更新，空间分辨率为 10-15 公里。

![](https://www.metax-tech.com/uploads/image/20240607/20240607092614_41906.png)

图 10 MPAS 模式计算流程示意图  
来源：https://mpas-dev.github.io/atmosphere/OpenACC/lagged_radiation.html

LICOM 是中国科学院大气物理研究所大气科学和地球流体力学数值模拟国家重点实验室（LASG）开发的全球海洋环流模式。在最新的 LICOM3 版本中，研发人员基于对 LICOM 海洋网格块的并行算法的分析，成功将 LICOM 的主要计算程序移植到 GPU 平台上，其中 90%以上的模式计算量由 GPU 完成。基于 GPU 加速的 LICOM3 实现了一个 1/20°的全球海洋模式版本，基准规模（384 卡）测试计算速度可以达到 CPU 版的 42 倍；全机规模（26200 卡）测试，可以实现 2.7（模式年/天）的模拟速度。

2021 年底，国家海洋预报中心发布了自主研发的新一代质量守恒海洋数值模式“妈祖 1.0”（MaCOM 1.0）。该模式具备全球和区域数值模拟能力，采用 GPU 并行加速，加速效果相对于 CPU 可达 140 倍，运行高效低耗，为国际海洋业务化同类模式首创。据测算，制作全球 10 公里分辨率的海洋环流数值预报，相比采用传统 CPU 超算的同类模式，可节省 80%以上的设备购置经费，降低能耗 90%以上，每年可节省约 200 万电费，相当于减少碳排放 520 吨（来源：自然资源部要闻播报）。

我们在广泛应用的中尺度预报模式 WRF 基础上，针对一组典型的模式参数配置，利用 OpenACC 并行技术对 WRF 的计算全流程（包括动力框架和物理过程）进行了 GPU 移植和加速。与 WRF 的商业版本 AceCAST 相比，加速性能非常接近甚至略占优势，同时还兼顾了移植工作的效率、程序的可读性和可维护性，这为其它气象模式向 GPU 移植提供了有益的参考。

![](https://www.metax-tech.com/uploads/image/20240607/20240607092814_96053.png)

图 11 不同加速方案的 WRF 模式计算效率对比

此外，还有很多 GPU 移植的研究性工作，聚焦于数值模式的某个物理过程模块，如长短波辐射过程、微物理过程、边界层过程等，研究结果表明在 GPU 上可以获得数十倍甚至百倍以上的加速，涉及到的模式包括 WRF、FV3、ICON、IFS、GRAPES 和 BCC-AGCM 等行业内耳熟能详的模式。

值得注意的是，对于数值天气预报模式这样复杂的软件，将其移植到 GPU 上并获得较高的性能并不容易，必须针对硬件特性和编程模型做针对性的优化，特别是业已成熟的数值模式，历史遗留代码负担重。以 WRF 模式为例，总计有近 100 万行的代码，全部移植到 GPU 上的工作量十分繁重，从而一定程度上阻碍了 GPU 加速在数值天气预报领域中的应用。

尽管如此，GPU 加速能给数值预报带来的潜在增益仍具有丰富的想象空间，特别是在新的预报模式顶层设计中应予以考虑。为了充分利用异构技术的优势，EC 正在和合作伙伴联合开发一个可移植且高效的代码库，用于其预报模式。预计到 2030 年，EC 将实现在异构 GPU/CPU 计算机架构上实施的预报系统。中国气象局在《全国气象发展“十四五”规划》中也明确指出，在研发下一代数值模式时，开展异构加速技术研究，改进高可扩展性并行算法，开发可移植的高性能代码库，开展数值模式移植。

## 4. AI 气象大模型
数值预报是一个系统性的工程，既需要超强的算力，也高度依赖于气象专家的专业知识和共同智慧，在经过百年的狂奔后，虽仍具有极强的生命力，但不可否认发展已经趋缓。AI for Science 自提出以来在多个基础科学领域攻城略地，成为科学研究的新范式，“AI+气象”也于过去的两三年内取得了令人瞩目的成绩，正在气象预报领域掀起一股世界性的研究热潮。

2022 年 3 月，基于傅里叶神经网络的 AI 预测模型 FourCastNet 拉开了序幕。FourCastNet 基于 EC 提供的高质量再分析资料 ERA5 数据集，用 64 个 A100 GPU 训练 16 小时得到，可在不到 2 秒的时间内生成一周预报，较数值预报加速 45000 倍。它首次把预报水平分辨率提升到了和数值预报相比拟的水平，即 0.25°×0.25°，但是其 0~7 天天气预报准确率仍然落后于 EC 综合预报系统（IFS）。

此后，Pangu-Weather（盘古气象大模型）横空出世。该模型基于三维神经网络，适配地球坐标系统，通过层次化时域聚合策略减少了迭代误差，成功实现了全球中期天气的精准预报。盘古同样使用 ERA5 数据集训练了 4 个不同预报间隔的模型，每个模型在 192 块 V100 GPU 上训练 15 天，只需要 1.4 秒就能完成 24 小时的全球气象预报，相比传统数值预报提速 10000 倍以上。同时在预报准确度上，盘古首次超过了数值天气预报 IFS 预报，引起了极大的轰动，其成果发表于顶级期刊《Nature》，并获得了代表国际数值预报最高水平的 EC 的认可。

2022 年 12 月，DeepMind 和谷歌开发了 GraphCast 模型，以提供高效的中期全球天气预报。GraphCast 也使用 ERA5 进行训练，模型建立在图神经网络和新颖的高分辨率多尺度网格表示之上，使用 32 块 TPU V4 训练了 21 天，可以在 60 秒内生成 10 天的预测。研究结果显示，GraphCast 在 99.2%的预报结果上超过了盘古气象大模型，在 90%的预报结果上超过了 EC 的高分辨率确定性预报（EC HRES）。

2023 年 4 月，上海人工智能实验室联合中国科学技术大学、上海交通大学、南京信息工程大学、中国科学院大气物理研究所及上海中心气象台发布了全球中期天气预报大模型 FengWu（风乌），风乌同样利用 ERA5 资料，在 32 块 V100 GPU 训练 17 天，而预报在 1 块 A100 GPU 上仅需 30 秒即可完成 10 天全球高精度预报。风乌提前 10 天的预报在 80%的评估指标上超越 GraphCast，首次将全球气象预报的有效时长提高到了 10.75 天，而 IFS 为 8.5 天。

2023 年 6 月，复旦大学人工智能创新与产业研究院联合大气与海洋科学系发布 FuXi（伏羲）气象大模型。伏羲提出了更加高效的 U-Transformer 结构，通过 Cascade 的方式级联模型，提升预报精度和时长。训练使用的数据集也为 ERA5，预训练采用 8 个 A100 GPU，耗费 30 小时。伏羲是首个预报未来 15 天的 AI 模型，0-9 天的预报结果优于 EC 集合平均（EC EM）结果，15 天的预报结果分别有 67.92% 和 53.75%的变量优于 EC EM。对比未来 10 天的预报，伏羲预报精度明显优于 GraphCast 模型和 EC HRES 确定性预报结果。

2023 年 7 月，清华大学联合国家气象中心、国家气象信息中心等单位，历经三年攻关，在中美两国近六年的雷达资料上训练出临近预报大模型 NowcastNet。在国际上首次将降水临近预报的时效延长至 3 小时，并弥补了极端降水预报的短板。在全国 62 位气象预报专家的过程检验中，该模型大幅领先国际上的同类方法，研究成果也发表于《Nature》。

![](https://www.metax-tech.com/uploads/image/20240607/20240607092851_50631.png)

图 12 几个主要的 AI 气象大模型对比

这还没有结束，气象大模型进化能力同样惊人。FourCastNet 很快就推出了新版的 FourCastNet V2 版本，盘古气象大模型团队在此前的基础上发布了首个人工智能区域预报模型“智霁”1.0，风乌团队释放了全球高分辨率 AI 气象预报大模型“风乌 GHR”，首次借助 AI 实现对中期天气进行 10 公里级的建模与预报，伏羲气象大模型团队提出了伏羲次季节大模型，预测时间范围比典型的中短期天气大模型更长，达到 45 天的预报时效。微软开源了首个天气-气候大模型 ClimaX，以执行广泛的天气预报和气候预测。连 EC 也忍不住亲自下场，发布了其首个 AI 气象大模型——AIFS，并对公众开放预报数据，其它气象机构也在争先恐后地追赶。

“AI 辅助天气预报的发展”被《Science》杂志评为 2023 年度十大科学突破之一，国家自然科学基金委员会在发布的 2023 年度中国科学十大进展中，“人工智能大模型为精准天气预报带来新突破”排名第一。

这些工作引起了行业内外广泛的关注和讨论，AI 给气象预报带来的冲击已经显现。气象大模型的涌现一方面受益于近年来 AI 技术的快速发展，以 Transformer 为代表的全新神经网络，奠定了大模型的算法架构基础，使大模型技术的性能得到了显著提升，另一方面气象领域积累的高质量的天气、气候观测和历史模拟数据对模型的预报效果功不可没，大部分 AI 模型不需要满足物理方程的约束，而是通过数据驱动的方式进行训练。

**气象大模型诞生的背后，更离不开强大算力的支持，GPU 在其中起到了关键性作用**，每个模型在训练过程中，都需要消耗大量的 GPU 算力，而这些模型用到的数据还仅仅是气象数据集中的一小部分，可以想象，随着更多的数据被采用，训练要求的算力资源将会进一步提升。而在预报阶段，推理过程仅需要少量的 GPU 资源，预报结果片刻之间即可得，相较于传统的数值天气预报，有 3 到 4 个数量级的计算效率提升。尤其是针对集合预报，气象大模型将具有巨大的优势。

## 5. 结语
从早期的观云识天，到现代的天气分析，再到数值天气预报，天气预报完成了从模糊到精确、从经验到科学的转变。历经百年风雨，数值天气预报早已是天气预报的核心科技，其发展一直伴随着科学计算技术的演进，并正在向 GPU 异构计算迈进。众多科技巨头和学术机构的入局，催生了 AI 气象大模型。AI 气象大模型的出现为气象研究带来革命性的改变，正在不断蚕食数值天气预报的领地，甚至引发了 AI 气象大模型会不会取代数值天气预报的讨论，尽管主流观点认为两者将融合发展。无论如何，毫无疑问 GPU 都将在其中发挥越来越重要的作用。

**参考资料**
[1] 陈德辉, 薛纪善. 数值天气预报业务模式现状与展望. 气象学报, 2004, 62 (5): 623-633
[2] 曾庆存. 天气预报——由经验到物理数学理论和超级计算. 物理, 2013, 42 (5): 300-314
[3] 沈学顺, 王建捷, 李泽椿, 等. 中国数值天气预报的自主创新发展. 气象学报, 2020, 78 (3): 451-476
[4] 赵立成, 沈文海, 肖华东, 等. 高性能计算技术在气象领域的应用. 应用气象学报,  2016, 27 (5): 550-558
[5] 张贺, 林朝晖, 曾庆存. 大气环流模式中动力框架与物理过程的相互响应. 气候与环境研究, 2011, 16 (1): 15-30
[6] 我国完全自主开发的“海洋环流数值模式‘妈祖 1.0’”正式发布. https://www.mnr.gov.cn/dt/ywbb/202112/t20211230_2716258.html
[7] Warner T T. Numerical Weather and Climate Prediction. Cambridge University Press. 2010
[8] Bjerknes V. Das Problem der Wettervorhersage, betrachtet vom Stanpunkt der Mechanik und der Physik. Meteor Zeits, 1904, 21:1-7
[9] Richardson L F, Chapman S. Weather prediction by numerical process. Dover Publications, 1965
[10] Charney J G, Fjörtoft R and von Neumann J. Numerical Integration of the Barotropic Vorticity Equation. Tellus A: Dynamic Meteorology and Oceanography, 1950, 2 (4): 237-254.
[11] Lam R, Sanchez-Gonzalez A, Willson M, et al. GraphCast: Learning skillful medium-range global weather forecasting. Science, 2023, 382: 1416-1421
[12] Bi K, Xie L, Zhang H, et al. Accurate medium-range global weather forecasting with 3D neural networks. Nature, 2023, 619: 533-538
[13] Chen L, Zhong X, Zhang F, et al. FuXi: a cascade machine learning forecasting system for 15-day global weather forecast. npj Clim Atmos Sci, 2023, 6: 190
[14] Zhang Y, Long M, Chen K, et al. Skilful nowcasting of extreme precipitation with NowcastNet. Nature, 2023, 619: 526-532
[15] https://arxiv.org/pdf/2304.02948. FengWu: Pushing the Skillful Global Medium-range Weather Forecast beyond 10 Days Lead
[16] https://arxiv.org/pdf/2202.11214.pdf. FourCastNet: A Global Data-driven High-resolution Weather Model using Adaptive Fourier Neural Operators
[17] https://arxiv.org/pdf/2301.10343.pdf. ClimaX: A foundation model for weather and climate
[18] Bauer P, Thorpe A, Brunet G. The quiet revolution of numerical weather prediction. Nature， 2015, 525: 47-55

