# 1 Introduction and lumped abstraction
![[6.002-Fig 1-Layers of Abstractions.png|层级的抽象]]
抽象的层次从观察到的自然现象开始(电路中的伏安关系)，
到物理规则层面的抽象(麦克斯韦电磁方程组和欧姆定律)，
到集中式电路层面的抽象(电路图中的电阻R/电源V/电容C等)，
到简单放大电路层面的抽象(电路图中的基本放大电路的符号)，
之后
1. 数字电路
	到数字电路层面的抽象(数字电路门)
	到组合逻辑层面的抽象(电路图中直接表示成一个函数)
	到时序数字逻辑层面的抽象
	到指令集层面的抽象(x86)
	到编程语言层面的抽象(C, C++, Java)
	到软件系统层面的抽象(操作系统，浏览器)
2. 模拟电路
	到运算放大器层面的抽象
	到滤波器层面的抽象
	到模拟电路系统构件层面的抽象(调节器，振荡器，射频放大器，电源供应)
最后到生活中各种应用器件层面的抽象(鼠标，面包机，声纳，音响等)

**集总电路抽象(Lumped Circuit Abstraction/LCA)**
该层抽象是从物理学到电子信息学的跨越

比如，要回答连接了一个电池的灯泡的电流是多少的问题
我们直接忽略了电流在灯丝中是如何流动的，也直接忽略了灯丝的形状、质量、方向、温度等性质
直接将其视为一个离散的电阻(discrete resistor)R，电阻R是解决这个问题唯一关心的量
然后画出电路图，直接计算$I = V/R$
问题解决

在此例中，电阻R就是灯泡的集中式电路元素抽象(a lumped element abstraction for the bulb)
运用集总电路元素抽象，我们可以直接分析我们所关心的量(比如电流$I$)，对于其他不相关的量(如光、热)，我们将其忽略

在运用集总电路抽象时，我们实际上作出了假设：不存在由磁场激发的电场，我们可以称这一假设或这一限制为集中式物质规则(Lumped Matter Discipline/LMD)
在该假设下，我们才可以使用集中式电路元素抽象，否则需要更深入地在物理学层面具体分析
在该假设下，基尔霍夫电压定律和基尔霍夫电流定律成立(麦克斯韦方程组被简化为KVL和KCL定律)
- 基尔霍夫电压定律(KVL)
	一个环路内的电压为0
	即对于一个环路(loop)，有$\sum_j v_j = 0$
- 基尔霍夫电流定律(KCL)
	一个结点内的电流为0
	即对于一个结点(node)，有$\sum_j i_j = 0$

# 2 Basic Circuit Analysis Method(KVL and KCL method)
![[6.002-Fig2.0-Demo Circuit1.0.png|样例电路]]

**方法1：电路分析中的基础KVL，KCL方法
(Method 1: Basic KVL, KCL method of circuit analysis)**
目标：确定电路中所有元素的电压和电流
步骤：
1. 写出逐元素的$v\text{-}i$关系
2. 写出所有节点的KCL定律
3. 写出所有回路的KVL定律
然后解方程组即可

例如，对于样例电路：
首先明确三类集中式电路元素(lumped circuit elements)
- 电阻$R$
- 电压源$V_0$
- 电流源$I_0$
电阻$R$两端的电压$V=IR$
电压源$V_0$两端的电压$V=V_0$
流经电流源$I_0$的电流$I=I_0$
因此我们得到
![[6.002-Fig2.1-Demo Circuit1.1.png]]

在规定物理量方向时，一般遵循关联变量规则(associated variables discipline)
即电流的方向一般取流入正电压端子(positive voltage terminal)，流出负电压端子(negative voltage terminal)
电压降的方向和电流的方向相同，元件的功率消耗可以用$vi$直接计算，结果为正
因此我们得到
![[6.002-Fig2.2-Demo Circuit1.2.png]]

然后依据分析步骤进行分析
目标：我们有$v_0$到$v_5$，以及$i_0$到$i_5$共12个未知量要求
步骤：
1. 逐元素的$v\text{-}i$关系
	$v_0 = V_0$($V_0$是已知量)
	$v_1 = i_1R_1$
	$v_2 = i_2R_2$
	$v_3 = i_3R_3$
	$v_4 = i_4R_4$
	$v_5 = i_5R_5$
	共6个方程
2. 逐结点的KCL定律
	$a: i_0 + i_1 + i_4 = 0$
	$b:i_2 + i_3 - i_1=0$
	$d: i_5 - i_3 - i_4 = 0$
	共3个独立的方程
3. 逐回路的KVL定律
	$L1:-v_0+v_1+v_2 = 0$
	$L2:v_1+v_3-v_4=0$
	$L3:v_3+v_5-v_2=0$
	$L4:-v_0+v_4+v_5=0$(该式是冗余的)
	共3个独立的方程
一共12个独立的方程，解12个未知量，方程组是可解的

**方法2：应用元素结合规则
(Method 2: Apply element combination rules)**
应用元素结合规则可以简化电路，常用的元素结合规则有：
![[6.002-Fig3.0-Element Combinatoin Rules.png]]

元素结合规则的应用举例：
![[6.002-Fig3.1-Example of Element Combination Rules.png]]

**方法三：结点分析
(Node Analysis)**
结点分析法是KVL和KCL定律的一种特定的应用方式(particular application of KVL, KCL method)
1. 选取一个参考点(reference node)($\perp$ground)
2. 标出其余结点相对参考点的电压(主要的未知量/primary unknowns)
3. 写出其余结点的KCL定律
4. 根据方程解出结点电压(node voltages)
5. 解出其他支路的电压、电流等(次要未知量/secondary unknowns)

结点分析的应用举例：
第一步，选取参考点(接地点)
第二步，标出其他结点相对参考点的电压
![[6.002-Fig4.0-Example of Node Analysis.png]]
第三步，写出其他结点的KCL定律(实际上也隐式地通过$(e_i-e_j)G$这样的形式使用了KVL定律)
(通过$(e_i-e_j)G$这样的形式表示电流而不是显式地设电流未知量$i_j,i_k$等，我们极大地减少了未知量，即我们直接完成了在方法一中先逐一写出KCL、KVL定律，然后将KVL定律代入到KCL定律的这两步过程)
![[6.002-Fig4.1-Example of Node Analysis.png]]
第四步，解出结点电压(两个KCL方程，两个未知数)
![[6.002-Fig4.2-Example of Node Analysis.png]]
方程组可以用矩阵乘法的形式表示
$$\begin{bmatrix}
G_1 + G_2 + G_3 & -G_3\\
-G_3 &G_3 + G_4 + G_5
\end{bmatrix}
\begin{bmatrix}
e_1 \\
e_2
\end{bmatrix} = 
\begin{bmatrix}
V_0G_1\\
V_0G_4+I_1
\end{bmatrix}$$
形式为电导矩阵乘以结点电压矩阵等于源矩阵
(conductance $\cdot$ node voltage=source)
电导矩阵中的元素为各个电导的线性组合
结点电压矩阵中的元素为各个结点的电压
源矩阵中的元素为电压源和电流源的线性组合
第五步，结点电压解出后，各电阻的电压即可解，进而电流也可解，问题解决

# 3 Superposition, Thévenin and Norton
对于满足线性性质(linearity)的电路，分析方法除了上节介绍的三种以外，还有三种可用的分析方法：叠加原理(superposition)、戴维宁定理(Thévenin)、诺顿定理(Norton)

叠加原理、戴维宁定理、诺顿定理的应用对象一定是线性电路
例如电路
![[6.002-Fig5.0-Example Circuit.png]]
应用结点分析方法，我们可以写出$$\frac {e-V} {R_1}+\frac e {R_2}-I=0$$我们注意到，等式中没有$eV,VI$这样的项，也就是等式关于$e,V,I$是线性的(linear in $e,V,I$)
实际上，我们可以将等式化为$$\left[\frac 1 {R_1}+\frac 1 {R_2}\right]e=\frac V {R_2}+I$$可以发现它的形式仍为电导$G$乘以结点电压$e$等于源$S$
其中$\frac 1 {R_1} + \frac 1 {R_2}$是电导$G$
$e$是结点电压
$\frac V {R_2} + I$是源$S$(各个源的线性组合)

而在这种形式下，我们解出的结点电压$e$，无疑是与源$S$(各个源的线性组合)成线性关系的，即$e$一定可以写为$e = a_1V_1 + a_2V_2+\dots b_1I_1+\dots$的形式
例如本例中，解出$e = \frac {R_2} {R_1 + R_2} V + \frac {R_1R_2} {R_1+R_2}I$

这就是线性电路，线性电路中的结点电压一定可以写成各个源(电流源和电压源)的线性组合的形式

线性性质(Linearity)存在，就意味着同质性(Homogeneity)和叠加性(Superpotition)存在
- 同质性(Homogeneity)
![[6.002-Fig6.0-Homogeneity.png]]
	例如，对于一个满足同质性的系统，在接收输入$x_1,x_2$时，得到的输出是$y$，如果将输入都乘上相同的常数$\alpha$，则得到的输出就是$\alpha y$
	在线性电路中，将所有的源($V$和$I$都乘上常数$\alpha$)，则结点电压$e$也都变为原来的$\alpha$倍
- 叠加性(Superposition)
![[6.002-Fig6.1-Superposition.png]]
	例如，对于一个满足叠加性的系统，在接收输入$x_{1a},x_{2a}$时，输出为$y_a$，在接收输入$x_{1b},x_{2b}$时，输出为$y_b$，如果输入为$x_{1a}+x_{1b},x_{2a}+x_{2b}$，输出就为$y_a+y_b$
	在线性电路中，源1的输入为$a_1$，源2的输入为$b_1$时，算出结点电压为$e_1$，而在源1的输入为$a_2$，源2的输入为$b_2$时，算出结点电压为$e_2$，当源1的输入为$a_1+a_2$，源2的输入为$b_1+b_2$，结点电压就为$e_1+e_2$

叠加性还有一个特别的应用
![[6.002-Fig6.2-Superposition.png]]
我们知道源1输入$V_1$，源2输入$V_2$时，结点电压$e$为$y_1+y_2$
令源2的输入为0，源1的输入不变，我们就能从$y_1+y_2$中分离出$y_1$，即$e$中仅由源1决定的那一部分
同理令源1的输入为0，源2的输入不变，我们就能从$y_1+y_2$中分离出$y_2$，即$e$中仅由源2决定的那一部分

**方法四：叠加原理
(Method 4: Superposition Method)**
一个电路的(总)输出(各支路的电流和电压)可以由令电路中的每个源单独工作时得到的输出相加得到(summing the responses to each source acting alone)
注意其中的“每个源”指的是相互独立的源(independent source)

我们知道结点电压相对源满足线性性质，因此满足叠加性，而每个支路的电流电压相对结点电压也满足线性性质($i = (e_i-e_j)G,v = e_i-e_j$)，也就是说各个$e_i,e_j$等也可以用$i_1,i_2$等和$v_1,v_2$等的线性组合表示，即$i,v$相对源满足线性性质，进而满足叠加性，因此得到叠加原理

从电路中去除源的影响的方法：将源替换为它们的阻抗
![[6.002-Fig7.0-Short and Open.png]]
- 对于电流源：将其开路
	理想电流源的内部阻抗为无穷大
	开路使得该支路电流从$I$变为$0$
- 对于电压源：将其短路
	理想电压源内部阻抗为0
	短路使得该支路电压从$V$变为$0$

叠加原理的使用举例：
![[6.002-Fig8.1-Example Circuit.png]]
首先将电流源开路，令电压源单独作用，算出此时的结点电压$e_V = \frac {R_2} {R_1+R_2} V$
然后将电压源短路，令电流源单独作用，算出此时的结点电压$e_I = \frac {R_1R_2}{R_1+R_2}I$
故电流源和电压源同时作用时，结点电压为$e = e_V + e_I$
![[6.002-Fig8.2-Solve the Example.png]]

**方法五：戴维宁定理
(The Thévenin Method)**
![[6.002-Fig9.0-Example Circuit.png]]
考虑图中的电路，一部分(内部)是任意的(线性)电路，其中包含了若干个电压源$V_m$，电流源$I_n$，以及电阻，另一部分(外部)是一个电流源$i$

通过叠加原理，我们知道，总体的电路在电流源$i$处这段(外部)支路产生的电压$v$可以写成是由各个源的作用线性组合的形式
$$v = \sum_m \alpha_m V_m + \sum_n \beta_n I_n + \gamma i$$
其中系数$\alpha_m$没有单位(no units)，
系数$\beta_n$的单位应该是电阻的单位(resistance units)(欧姆定律$V = RI$)，
系数$\gamma$的单位也应该是电阻的单位，
因此我们可以把$\gamma$写成一个电阻$R$($R$实际由电路中的所有电阻组合计算得到)

$\alpha_m,\beta_n,\gamma$这些系数与电路外部激励(excitation)无关(independent)，在此例中，就是与外部电流源$i$无关，只与(内部)电路内部的电阻有关
(实际上它们都是由内部电路中所有的电阻组合计算得到)

如果我们令$i=0$(开路电流源$i$)，我们就得到了仅由内部电路的$V_m$和$I_n$决定的支路电压$v_{TH}=\sum_m\alpha_mV_m + \sum_n\beta_nI_n$，$v'$直接表示了内部电路中所有的源对于该支路的总的作用
如果我们令$\forall V_m=0,\forall I_n=0$(短路电压源$V_m$，开路电流源$I_n$)，我们就得到了仅由外部电路$i$决定的支路电压$v'=R_{TH}i$，其中的$R_{TH}$直接表示了内部电路中所有的电阻对于该支路的总的作用

因此，如果我们只关心那一条支路(或者说支路电压$v$)，从这个(外部)支路的角度来看，它的构成可以直接写成
$$v = v_{TH} + R_{TH}i$$
其中$v_{TH}$表示了内部源的总作用，$R_{TH}$表示了内部电阻的总作用

这其实等效于将内部的电路视为一个电压源$v_{TH}$和一个电阻$R_{TH}$串联
(当内部的电路是电压源$v_{TH}$和电阻$R_{TH}$串联时，$v$仍然等于$v_{TH} + R_{TH}i$)
而$v_{TH}$就是内部电路对外部支路的开路电压
(保持内部电路不变，将外部激励都移除时，测量该支路两端点得到的电压)
$R_{TH}$就是外部电路看内部电路的等效电阻
(保持外部激励不变，将内部电路的源都移除，测量该支路两端点得到的电压，再通过$R = V/I$计算得到的电阻)
![[6.002-Fig9.1-Equivalent Circuit.png]]

也就是说对于外部支路来说，把内部电路简化成一个电压源和一个电流源串联，或者不简化内部电路，是没有区别的

这就是戴维宁定理，在求解外部电路的物理量时，我们可以用戴维宁等效电路替换复杂的内部电路

戴维宁定理的描述如下：
任意一个由线性电阻、线性受控源和独立电源组成的一端口电路对外部的作用都可以用一个理想电压源$U$和电阻$R$的串联电路来等效，
此理想电压源$U$在数值上等于一端口电路在端口处的开路电压$u_{oc}$(open circuit voltage)，而电阻$R$是该端口内部所有独立电源不起作用时端口处的等效电阻
![[6.002-Fig9.2-Thevenin Method.png]]

戴维宁定理应用举例
![[6.002-Fig9.3-Example Circuit.png]]
图中的电路中有一个用虚线框住的端口电路，显然该端口电路是线性的，我们关心的量是流入并流出这个端口的电流，因此将该端口电路替换成它的戴维宁等效电路
![[6.002-Fig9.4-Example Circuit.png]]
其中$V_{TH}$为端口开路电压(将外部电路整体替换为开路)，
$R_{TH}$为去除内部源时的内部总电阻
![[6.002-Fig9.5-Example Circuit.png]]

**方法六：诺顿定理
(The Norton Method)**
![[6.002-Fig9.6-Example Circuit.png]]
任意一个由线性电阻、线性受控源和独立电源组成的一端口电路对外部的作用都可以用一个理想电流源$U$和电阻$R$的并联电路来等效，
此理想电流源$I$在数值上等于端口电路在端口处的短路电流$i_{sc}$(open circuit current)，而电阻$R$是该端口内部所有独立电源不起作用时端口处的等效电阻

端口电路在端口处的短路电流数值上等于将外部电路整体替换成短路后流经端口的电流，可以借助其戴维宁等效电路来计算：$$I_{N} = \frac {V_{TH}} {R_{TH}}$$

# 4 The Digital Abstraction
首先从一个模拟信号处理电路引入
![[6.002-Lecture4-Fig1-Adder Circuit.png]]
电路中存在两个电压源$V_1,V_2$，它们可以代表两个传感器的输出
通过叠加原理，可以求得端点电压$V_0 = \frac {R_2} {R_1+R_2} V_1 + \frac {R_1}{R_1 + R_2} V_2$

若$R_1 = R_2$，则$V_0 = \frac 1 2(V_1 + V_2)$，即该电路的处理作用是两个传感器的输出取平均值然后输出，其中$V_1 + V_2$表示对电压直接进行了线性的叠加
如果加上时间轴，忽视常数$\frac 1 2$，则输出电压$V_0$的波形就是两个输入电压$V_1,V_2$的波形的叠加

如果为了在远处监听输出$V_0$，我们在这个端点之后引上电线至远处
![[6.002-Lecture4-Fig2-Noise Problem.png]]
我们将会发现，发送端点处，我们得到的是完美的$V_1$和$V_2$叠加的波形，但在接收端点处，我们收到的波形相较于发送端的波形多了大量的波动
这是因为传输过程总是不可避免地会遭遇噪音，影响电压值，使其产生波动
因此，发送端发送$3V$的电压，经过噪声影响，我们可能在接收端收到$2V$，也可能收到$4V$，这使得我们无法准确确认发送端发送的准确信息

为了解决噪声对于信息传递带来的影响，我们引入值离散化(value discretization)
令我们传递的信息只能为离散值0或1，不传递连续值(如0.5, 0.8, 1.2等)
(我们不直接传递连续值，而是传递离散值，并用离散值表示连续值)
![[6.002-Lecture4-Fig3.png]]
由此就构成了数字系统，规定高电位为1，低电位为0
因为离散化，数字系统有效地帮我们解决了噪声对于信息传递的影响
![[6.002-Lecture4-Fig4.png]]
例如图中，传输1时输出$5V$，传输0时输出$0V$，以$2.5V$为界划分高低，此时$0.2V$的噪声波动不会影响信号的传输

数字系统带来了更好的抗噪声性(noise immunity)，更高的噪声容限(noise margin)
例如上例中，
传输1的噪声容限是$5V-2.5V = 2.5V$，传输0的噪声容限是$2.5V-0V=2.5V$

一般来说，输入的电压不容易保持一个固定值
如果我们在通信协议中规定：
高于电压阈值(voltage threshold)为高电压，低于电压阈值为低电压，发送端要发送1时，输出高电压即可，要发送0时，输出低电压即可，接收端收到低电压，则解释为0，接收端收到高电压，则解释成1
![[6.002-Lecture4-Fig5.png]]
这将会带来两个问题
问题一：阈值电压的信息无法定义
当接收端收到了$2.5V$时，它的信息是无法定义的
并且，由于高电压的范围和低电压的范围仅以$2.5V$分割，即它们的域是紧挨的，这增大了噪声影响信息的可能性(事实上此时0和1的噪声容限都是$0V$)
例如发送端传递$2.49V$表示0，但接收端很可能收到$2.51V$解释为1

因此，需要划定禁区(forbidden region)，并且直接规定，接收方收到禁区内的电压是，信息是未定义的(undefined)，元件收到未定义信息时行为由设计者决定
![[6.002-Lecture4-Fig6.png]]
但此时，传输1的噪声容限是和传输0的噪声容限仍是$0V$
(例如发送者在发送$3V$作为1时，只要有任意小的干扰，例如$0.01V$，接收者就可能收到$2.99V$，解释为未定义)

问题二：噪声容限为0
为了提高噪声容限，需要缩小发送端的发送电压范围，例如
![[6.002-Lecture4-Fig7.png]]
此时，传输1的噪声容限为$V_{IH} - V_{OH}$，即在$V_{IH}-V_{OH}$的噪声下，不影响信息传输，传输0的噪声容限为$V_{IL} - V_{IH}$，即在$V_{IL}-V_{IH}$的噪声下，不影响信息传输

至此，我们规定了四个阈值$V_{OH},V_{OL},V_{IH},V_{IL}$
发送者遵循两个阈值$V_{OH},V_{OL}$
要发送1时，要求电压高于$V_{OH}$，要发送0时，要求电压低于$V_{OL}$
接收者遵循两个阈值$V_{IH},V_{IL}$
接收电压高于$V_{IH}$时，解释为1，接收电压低于$V_{IL}$时，解释为0
此时，传输1的噪声容限为$V_{IH} - V_{OH}$，传输0的噪声容限为$V_{IL} - V_{IH}$

在四个阈值下，接收者与发送者的通信过程举例：
![[6.002-Lecture4-Fig8.png]]
本例中发送者随着时间增长，需要发送信息0101，因此在要发送0时，输出低于$V_{OL}$的电压，在要发送1时，输出高于$V_{OH}$的电压，在接收端，接收到的高于$V_{IH}$的电压，解码为1，接收到低于$V_{IL}$的电压，解码为0，因为传输过程中的噪声没有超过阈值，故信息正确传递，接收端得到信息0101

数字系统都遵循静态规定(static discipline)，静态规定规定了这四个阈值，并且要求，如果数字系统的输入满足有效的输入阈值，则数字系统的输出也需要满足有效的输出阈值
换句话说，即数字系统在接收输入时，以$V_{IH},V_{IL}$为阈值，解码信息，而数字系统在输出信息时，以$V_{OH},V_{OL}$为阈值，编码信息
例如，数字系统在接收到高于$V_{IH}$但低于$V_{OH}$的电压时，将其解码为1，而要向外输出这个1时，则必须输出高于$V_{OH}$的电压，不论它接收到时的电压是多少

了解了模拟系统到数字系统的转换之后(通过静态规定，将模拟信号转换为数字信号)，我们接下来了解数字系统对于数字信号的处理(process digital signals)

数字系统仅处理两个离散值0和1，
0和1可以直接表示逻辑值$T,F$，也可以以二进制形式表示数字

因为0和1可以用于表示逻辑值，则数字系统就可以表示整个布尔逻辑系统
例如，布尔逻辑中的AND运算，在数字系统中就可以用与门表示
数字逻辑(digital logic)的设计者并不需要关心数字门内的结构，他们在组合门抽象(combinational gate abstraction)之上工作
数字门的两个性质：
- 数字门内部仍然严格遵循静态规定(因此数字门也具有了噪声抗性)
- 数字门的输出仅和数字门的输入有关(outputs are a function of inputs alone)

与门的工作图像举例
![[6.002-Lecture4-Fig9.png]]
本例中，输入$x,y$中只要有一个是低电平(0)，则输出$z$就为低电平(0)，若两个都是高电平(1)，则输出高电平(1)
(实际中与门得到输入$x,y$往往不是如此平直的线，而是在噪声的影响下上下浮动，但门电路遵循了静态规定，因此在噪声容限内，输出不会受到影响)

# 5 Inside the Digital Gate
要了解数字门的内部，首先了解开关(switch)
![[6.002-Lecture5-Fig1.png]]
开关是一个三端设备，其中$C$是控制信息，
当$C=0$，开关断开，电路为开路
当$C=1$，开关连接，电路为短路
数字门的输入信号就是作为内部开关的控制信息控制电路的开闭以控制输出电压的高低

非门
![[6.002-Lecture5-Fig2.png]]
在非门的内部电路中，$V_s$为电压源，$C$端接收输入信号，$V_{OUT}$为输出电压
当输入信号$C=0$，开关断开，发生开路，则$V_{OUT} = V_s$，输出高电压，即$1$
当输入信号$C=0$，开关连接，发生短路，则$V_{OUT} =0$，输出低电压，即$0$
因此该电路构成了非门逻辑

与非门
![[6.002-Lecture5-Fig3.png]]
当输入信号$c_1 = 0,c_2  = 0$，开关都断开，发生开路，则$V_{OUT} = V_s$，输出高电压，即输出$1$
当输入信号$c_1 = 0, c_2 = 1$，开关一断一闭，发生开路，则$V_{OUT} = V_s$，输出高电压，即输出$1$
当输入信号$c_1 = 1, c_2 = 0$，开关一断一闭，发生开路，则$V_{OUT} = V_s$，输出高电压，即输出$1$
当输入信号$c_1 = 1, c_2 = 1$，开关都闭合，发生短路，则$V_{OUT} = 0$，输出低电压，即输出$0$
因此该电路构成了与非门逻辑

或非门
![[6.002-Lecture5-Fig4.png]]
当输入信号$c_1 = 0,c_2  = 0$，开关都断开，发生开路，则$V_{OUT} = V_s$，输出高电压，即输出$1$
当输入信号$c_1 = 0, c_2 = 1$，开关一断一闭，发生短路，则$V_{OUT} = 0$，输出低电压，即输出$0$
当输入信号$c_1 = 1, c_2 = 0$，开关一断一闭，发生短路，则$V_{OUT} = 0$，输出低电压，即输出$0$
当输入信号$c_1 = 1, c_2 = 1$，开关都闭合，发生短路，则$V_{OUT} = 0$，输出低电压，即输出$0$
因此该电路构成了与非门逻辑

开关实质上是一种MOSFET设备(Metal-Oxide Semiconductor Field-Effect Transistor/金属氧化物半导体场效应晶体管)
MOSFET设备简称场效应管(FET)或晶体管(Transistor)
在电路中，我们常常将该设备其集总抽象为一个三端开关元件
![[6.002-Lecture5-Fig5.png]]
MOSFET设备有三个接线端，分别是栅极(gate)，漏极(drain)，源极(source)
其中栅极$G$作为控制接线端

![[6.002-Lecture5-Fig6.png]]
MOSFET设备的输入电压是栅-源极电压$v_{GS}$，输出电压是漏-源极电压$v_{DS}$
当栅-源极电压大于一定的阈值电压$V_T$(一般在$1V$左右)，漏极和源极将会导通，表现出短路，此时漏-源极电压$v_{DS} = 0$
当栅-源极电压小于一定的阈值电压$V_T$(一般在$1V$左右)，漏极和源极则断开，表现出开路，此时栅极电流$i_G =0$
此即MOSFET设备的理想 开关模型(S模型)

MOSFET设备的伏安特性曲线
![[6.002-Lecture5-Fig7.png]]
当$v_{GS}$大于等于阈值电压$V_T$，晶体管导通，$V_{DS}= 0$
当$v_{GS}$小于阈值电压$V_T$，晶体管断开，$i_{DS} = 0$

因此，实际的非门/反相器(inverter)的内部结构是
![[6.002-Lecture5-Fig8.png]]
在电路分析中，我们直接将其抽象为一个非门符号，因此就不需要其内部的细节，如$V_s,R_L,GND$等

反相器的$V_{IN}-V_{OUT}$曲线
![[6.002-Lecture5-Fig9.png]]
当输入电压$V_{IN} \le V_T$，漏源极断开，输出电压$V_{OUT} = V_s = 5V$
当输入电压$V_{IN} > V_T$，漏源极连接，输出电压$V_{OUT} = 0V$
该反相器也满足特定的阈值(静态规则)
例如对于四个阈值$V_{OL} = 0.5V, V_{IL} = 0.9V, V_{OH} = 4.5V, V_{IH} =4.1V$
反相器输出1时，输出电压高于$V_{OH}$
反相器输出0时，输出电压低于$V_{OL}$
反相器视任何高于$V_{IH}$的输入为1
反相器视任何低于$V_{IL}$的输入为0

MOSFET设备除了S模型以外，还有更详细的SR模型(Swithc resistor)
![[6.002-Lecture5-Fig10.png]]

SR模型展示了更多的细节，如果需要反相器满足特定的静态规定时，可以选择特定大小的电阻$R_{ON}$
![[6.002-Lecture5-Fig11.png]]


# 6 NonLinear Analysis
门电路从总体上看是非线性电路(输入输出电压曲线是非线性的)，但如果给定一个特定的输入(指定每个开关的闭合)，此时电路是线性的(门电路在给定开关设置下成为了线性电路)
对于一个非线性电路的分析，可以采用
- 解析方法(Analytical method)
	即基于之前介绍的前三种基础电路分析方法
-  图形方法(Graphical method)
- 增量分析法(Incremental analysis)

样例电路
![[6.002-Lecture6-Fig1.png]]
该电路中包含一个非线性元件$D$，
假设$v_D$是元件两端的电压，$i_D$是流经元件的电流，则其关系为$i_D = ae^{bv_D}$
可以看到$i_D,v_D$不呈线性关系，而呈指数关系

对于非线性电路的分析仍可以采用结点分析法
![[6.002-Lecture6-Fig2.png]]
首先确定接地点，然后选取电阻$R$和元件$D$之间的那个结点进行分析，
写出方程
$\frac {v_D - V} R + i_D = 0$
$i_D = ae^{bV_D}$
两个方程可以解出两个未知数$i_D,v_D$

也可以采用更直观的图像法
![[6.002-Lecture6-Fig3.png]]
根据两个方程
$\frac {v_D - V} R + i_D = 0$
$i_D = ae^{bV_D}$
分别画出$i_D \text{-} V_D$图像，两图像的交点即同时满足两个方程的解
![[6.002-Lecture6-Fig4.png]]

非线性电路也可以采用增量分析法，将在下节介绍，为此先做问题引入
![[6.002-Lecture6-Fig5.png]]
在第一个电路中，输入$v_I$是声音信号，作为电压源为$LED$施加电压，$LED$是非线性元件，即$i_D,v_D$呈非线性关系(假设呈指数关系$i_D = ae^{bv_D}$)，$LED$发出光线，由第二个电路中的光敏元件接收，光敏元件根据光线强度输出电流$i_R$，$i_R$流经放大器$AMP$
第一个电路是非线性电路，第二个电路是线性电路，这两个电路的组合的作用是对声音进行放大

但由于$LED$非线性元件的性质，放大后的声音会产生失真(distortion)
![[6.002-Lecture6-Fig6.png]]
如果第一个电路中没有其他电阻，则$v_D = v_i$，$v_D$的波形呈正弦波，而由于$LED$的非线性性质，$i_D$的波形发生了失真，进而导致输入至第二个电路的信号发生了失真

如果$LED$是线性元件，则不会有类似的效果
![[6.002-Lecture6-Fig7.png]]
# 7 Incremental Analysis
在之前的问题中，非线性元件的非线性性质($i_D = ae^{bV_D}$)导致了信号的失真，如果将元件替换成线性元件就可以直接解决问题
但除此以外，一个更简便的方法是利用
1. 偏置
2. 微小增量(对于可微函数，$\Delta y = f'(x_0)\Delta x$在$\Delta x \to 0$时成立 )
使非线性函数近似线性函数

![[6.002-Lecture7-Fig1.png]]
在非线性函数$i_D = ae^{bV_D}$的图像中，可以选择一段微小的曲线，例如曲线在点$(V_D, I_D)$后的一段微小曲线，在这段微小的曲线内，自变量$v_D$的增量$\Delta v_D$是一个非常微小的增量，同时因变量$i_D$的增量$\Delta i_D$也是一个非常微小的增量，在这个区域内，$\Delta i_D$和$\Delta v_D$呈近似线性关系

![[6.002-Lecture7-Fig2.png]]
因此，我们将输入分成两部分：直流偏置电压$V_D$和交流微小变化电压$v_i(t)=v_d$
因此非线性元件的两侧电压$v_D = v_I = V_I + v_d$
因此，我们可以将流经非线性元件的电流也分为两部分：直流偏置电压带来的电流$I_D$和交流微小变化电压带来的电流$i_d$
而对于一个可微函数，在$\Delta x\to 0$时，$\Delta y$和$\Delta x$满足线性关系
因此，在$v_d$非常微小的情况下($\Delta v_I\to 0$)，$i_d$和$v_d$呈线性关系($\Delta v_D$和$\Delta i_D$呈线性关系)

可以看到，我们首先提供一个恒定的直流输入，得到一个恒定的直流输出，
然后将交流信号输入视作微小的增量(添加微小变化的交流信号输入)，利用可微函数的性质，得到了相较于交流信号输入线性变化的输出增量(由此得以保留输入信号的完整变化波形，避免失真)
因此该方法被称为增量分析(incremental analysis)

![[6.002-Lecture7-Fig3.png]]
增量分析三步骤：
1. 提供一定的直流偏置
2. 在直流偏置上叠加小信号量(输入增量)
3. 得到和小信号量输入近似线性关系的小信号量输出(输出增量)

![[6.002-Lecture7-Fig4.png]]
也可以通过泰勒级数理解该线性关系
设$i_D = f(v_D)$，其中$f(\cdot)$是任意的一个非线性函数
令$v_D = V_D + \Delta v_D$(即一个直流偏置量和一个微小的交流增量)，将$i_D = f(v_D)$在$V_D$处进行多项式展开，得到($n$阶可导的函数就得到$n$次的泰勒多项式)
$$i_D = f(V_D) + f'(V_D)\Delta v_D + \frac 1 2f''(V_D)\Delta v_D^2 + \cdots$$

![[6.002-Lecture7-Fig5.png]]
因为增量$\Delta v_D$很小，因此近似忽略高阶项，即
$$i_D \approx f(V_D) + f'(V_D)\Delta v_d$$
故$$\Delta i_D = i_D - f(V_D) \approx f'(V_D)\Delta v_d$$
$\Delta i_D$和$\Delta v_d$呈线性关系，其中系数$f'(V_D)$是与$\Delta v_d$无关的常数
而$I_D = f(V_D)$，$(V_D,I_D)$称为直流工作点(operating point)，工作点也与$\Delta v_d$无关

![[6.002-Lecture7-Fig6.png]]
图像上看，我们在微小增量的情况下，用直线近似了曲线

![[6.002-Lecture7-Fig7.png]]
电路上看，如果只相对于微小信号量，系数$f'(V_D)$与$v_d$无关，因此可以视为电阻

# 8 Dependent Sources and Amplifiers
![[6.002-Lecture8-Fig1.png]]
电阻、独立电流源这样的设备属于单端口设备(1-port devices)
一个端口即一对接线端(terminals)

而受控源(dependent source)属于双端口设备(2-port device)，一个端口是控制端口(control port)，用于接收输入控制信号，一个端口是输出端口(output port)，用于输出电压/电流

受控源可以分类为四种
- 电压控制电流源(Voltage Controlled Current Source/VCCS)
- 电压控制电压源(Voltage Controlled Voltage Source/VCVS)
- 电流控制电流源(Current Controlled Current Source/CCCS)
- 电流控制电压源(Current Controlled Voltage Source/CCVS)

对于独立源，其输出是固定的：
![[6.002-Lecture8-Fig2.png]]


对于受控源，其输出信号则受输入信号控制：
![[6.002-Lecture8-Fig3.png]]

例如上图电路中，受控电流源的输出电流与输入电压存在函数关系$I = f(V) = \frac K V$
同时，电压$V$也直接施加在了电阻$R$上

![[6.002-Lecture8-Fig4.png]]
对该电路同样可以采用结点分析法，即$\frac V R = I = \frac K V$，得$V = \sqrt {KR}$

受控源内得输入输出关系也可以是非线性的：
![[6.002-Lecture8-Fig5.png]]
在上图电路中，受控电流源的输入电流与输入电压存在函数关系
$$i_D = f(v_{IN}) = \begin{cases} \frac K 2(v_{IN}-1)^2,&v_{IN}\ge1\\
0,&otherwise\end{cases}$$

该电路可以简化为下图
![[6.002-Lecture8-Fig6.png]]
进一步简化为下图
![[6.002-Lecture8-Fig7.png]]

要得到$v_0$关于$V_I$的关系，仍然可以利用结点分析法：
![[6.002-Lecture8-Fig8.png]]
由流入结点和流出结点的电流相等可得$$\frac {V_s - v_0} {R_L}=i_D$$当$v_{IN}\ge 1$时，$i_D = \frac K 2(v_{IN}-1)^2$，故$v_0 = V_s - \frac K 2(_I -1)^2R_L$
当$v_{IN} < 1$时，$i_D = 0$，故$v_0 = V_s$

放大器是一个三端口设备，存在一个输入端口和一个输出端口，以及一个电源端口
放大器的一个关键作用是提高信息的噪声容限

例如，在信号的振幅较小时，轻微的噪声就会完全干扰信号
![[6.002-Lecture8-Fig9.png]]
而通过放大器放大信号的振幅，就提高了信号的噪声容限
![[6.002-Lecture8-Fig10.png]]

在静态规则中，也隐含了放大器的思想
![[6.002-Lecture8-Fig11.png]]
![[6.002-Lecture8-Fig12.png]]


但在实际电路中，常常省略放大器的电源端口，并且通常认为这三个端口的两个接线端中一个接线端是地点
![[6.002-Lecture8-Fig13.png]]


之前举例的包含受控电流源的电路实际上就可以作为一个放大器的内部电路
该电路有三个端口：$V_S$电源端口、$v_I$输入端口、$v_O$输出端口
![[6.002-Lecture8-Fig14.png]]
经过推导我们有：
当$v_{IN}\ge 1$时，$i_D = \frac K 2(v_{IN}-1)^2$，故$v_o = V_s - \frac K 2(v_{IN} -1)^2R_L$

给定一些值，可以画出$v_O-v_I$图像
![[6.002-Lecture8-Fig15.png]]
可见在曲线的一定区域，满足$\frac {\Delta v_O} {\Delta v_I} > 1$(切线斜率大于1)
即该电路对交流输入信号$\Delta v_I$进行了放大，输出交流输出信号$\Delta v_O$

虽然经过推导，我们有
当$v_{IN}\ge 1$时，$i_D = \frac K 2(v_{IN}-1)^2$，故$v_o = V_s - \frac K 2(v_{IN} -1)^2R_L$
![[6.002-Lecture8-Fig16.png]]
当$v_I$大于1且不高于一定阈值，计算出的$v_O > 0$，此时$v_O$实际的能量来源是电源端口输出$V_S$
但当$v_I$高于一定的阈值时，如果计算出的$v_O<0$，则要求VCCS必须是一个可以供能的元件

因此，如果VCCS是一个可以作为供源的元件，则
![[6.002-Lecture8-Fig17.png]]
但事实上，VCCS是一个无源器件(passive device)，则实际上在接近阈值点的时候，VCCS的行为会发生变化，其行为会更像一个电阻，关系$i_D = \frac K 2(v_{IN}-1)^2$将会变得无效，$i_D$趋向饱和，因此实际观察到的现象是输出$v_O$逐渐向0靠拢
![[6.002-Lecture8-Fig18.png]]
# 9 MOSFET Amplifier Large Signal Analysis
在带有受控源(dependent source)的电路使用叠加原理时，只需要保留受控源，对独立源(independent source)做叠加原理分析即可(一次保留一个独立源)

之前我们讨论过MOSFET的SR模型，即$v_{GS} < V_T$时，MOSFET表现为断路，当$v_{GS} \ge V_T$时，MOSFET表现为一个电阻
但这实际上简化了模型，在$v_{GS} \ge V_T$时，MOSFET并不是表现为一个阻值恒定的电阻，随着$v_{DS}$增大，流经的电流$i_{DS}$增大，阻值也随之增大，直到$v_{DS}$足够大，$i_{DS}$达到饱和值，不再增大，保持恒定，此时MOSFET表现出电流源的性质，即阻值无穷大，电流恒定
![[6.002-Lec9-Fig1.png]]
该模型称为MOSFET的开关电流源模型(switch current source model/SCS)
$i_{DS}$达到饱和的点就是$v_{DS} = v_{GS} - V_T$的点，当$v_{DS}$继续增加，$i_{DS}$保持不变，且电流满足$i_{DS} = \frac K 2 (v_{GS} - V_T)^2$
显然饱和点与$v_{GS},V_T$有关，因此在$v_{GS}$不同时，存在不同的饱和点
当$v_{DS}\ge v_{GS} - V_T$，MOSFET处于饱和区
当$v_{DS}\le V_T$，MOSFET处于三极区(triode region)

SR模型($v_{DS}< v_{GS} - V_T$)一般用于数字电路设计，SCS模型($v_{DS}\ge v_{GS}-V_T$)一般用于模拟电路分析

结合上节所介绍，可以发现MOSFET工作在饱和区时，就可以作为放大器使用，因为此时电流关系满足$i_{DS} = \frac K 2 (v_I - V_T)^2$
因此要使用放大电路就要首先保证$v_{GS} \ge V_T$(即$v_I \ge v_T$)，然后保证$v_{DS}\ge v_{GS} - V_T$
(即$v_O \ge v_I - v_T$)，可以称其为饱和规则(saturation dispiline)
![[6.002-Lec9-Fig2.png]]

了解饱和规则之后，就可以分析使用MOSFET放大器的电路了
![[6.002-Lec9-Fig3.png]]
首先将MOSFET用它的SCS模型替代

分析电压电流关系
![[6.002-Lec9-Fig4.png]]
首先由MOSFET的SCS模型知道，
在$v_I\ge V_T$且$v_O \ge v_I - V_T$时，电流满足$i_{DS} = \frac K 2 (v_I - V_T)^2$，而$v_O = V_S - i_{DS}R_L$
因此将电流代入可以得到$v_O = V_S - \frac K 2(v_I - V_T)^2R_L$
在$v_I \le V_T$时，MOSFET断开，$v_O = V_S$

![[6.002-Lec9-Fig5.png]]
而当在$v_I\ge V_T$且$v_O \ge v_I - V_T$时，电流满足$i_{DS} = \frac K 2 (v_I - V_T)^2$，将$v_I- V_T$用$i_{DS}$表示，可以得到$(v_I - V_T) = \sqrt \frac {2i_{DS}} {K}$，
因此$v_O$满足$v_O\ge \sqrt \frac {2i_{DS}} {K}$，$i_{DS}$满足$i_{DS} \le \frac K 2 v_o^2$
而我们又知道，电路工作时，始终满足$i_{DS} = \frac {V_S} {R_L} - \frac {v_O}{R_L}$
由约束条件和负载线，可以画出$v_O$和$i_{DS}$的图像
![[6.002-Lec9-Fig6.png]]
在饱和区就满足了约束A，此时给定$V_I$，找到它和负载线的交点，就可以找到$V_O$和$I_{DS}$

接下来讨论放大器下的大信号分析(large signal analysis)(在饱和规则下)
首先是输入电压和输出电压的关系
![[6.002-Lec9-Fig7.png]]
当$v_I$小于$V_T$时，MOSFET断开，$v_O = V_S$
当$v_I$大于$V_T$时，
在$v_o \ge v_I - V_T$，MOSFET处于饱和区，满足$v_o = V_S - \frac K 2 (v_I - V_T)^2R_L$
随着$v_I$增大，$v_O$逐渐减小，直到$v_O = v_I - V_T$，之后若$v_I$继续增大，MOSFET就进入三极区，表现为一个电阻

然后讨论在饱和规则下的有效的工作范围(operating ranges)
之前已经推导出，要处于饱和区，需要满足$i_{DS}\le \frac K 2v_o^2$
![[6.002-Lec9-Fig8.png]]
联立$i_{DS} = \frac K 2 (v_I - V_T)^2$和$i_{DS} = \frac {V_S} {R_L} - \frac {v_O}{R_L}$以及$i_{DS} = \frac K 2 v_O^2$可以得到
![[6.002-Lec9-Fig9.png]]
因此在饱和规则下，有效的输入范围是$V_T$到$V_T + \frac {-1 + \sqrt{1+2KR_L V_S}} {KR_L}$
对应的有效的输出范围是$V_S$到$\frac {-1 + \sqrt{1 + 2KR_LV_S}}{KR_L}$





