# 1 函数、极限与连续
## 1.1 函数
### 1.1.1 函数的概念
一元函数：$f: X \rightarrow R\quad y = f(x)$  
要求不能一对多，一个$x\in X$只能对应唯一的一个$y \in R$
定义域，值域

基本初等函数：
1. 幂函数(power)
2. 指数函数(exponential)
3. 对数函数(logarithmic)
4. 三角函数
5. 反三角函数

### 1.1.2 函数的几种性质
1. 有界性
	$\exists M,\forall x\in X\quad  |f(x)| \leqslant M$
2. 单调性(在单调区间内单调) 
3. 奇偶性(定义域首先要关于原点对称)
4. 周期性
### 1.1.3 复合函数和反函数
复合函数：$y = f(g(x)) = f(u)$，$u$为中间变量
要求是$R(g) \subseteq D(f)$

反函数：$x = f^{-1}(y)$
要求一个$y$只能对应唯一的一个$x$

单调函数的反函数一定存在且单调

### 1.1.4 映射
函数是映射的像集为实数集的特例

单射：没有多个$x$对应同一个$y$
满射
双射：单射+满射

反函数是逆映射的特例

### 1.1.5 初等函数和非初等函数
由基本初等函数经过有限次的四则运算和函数复合所构成

可以显式地写出：$y=f(x)$为显函数
只能$F(x, y) = 0$表示的为隐函数，为非初等函数

## 1.2 极限
### 1.2.1 引例
极限研究的是函数的变化趋势

### 1.2.2 自变量趋于有限值时函数的极限
定义：函数$f(x)$在$x_0$的某去心邻域内有定义，对于$\forall \epsilon>0$，$\exists \delta>0$，当$x$属于$x_0$的$\delta$去心邻域时($0 < |x-x_0| < \delta$)，都满足$|f(x) - a| < \epsilon$
称：$\lim_{x \to x_0} f(x) = a$

极限存在的关键是$\delta$是否存在

单侧极限即$x$不是从两侧趋近于$x_0$，而是从左右两侧中的一侧
极限存在的充要条件是左右极限存在且相等

### 1.2.3 自变量趋于无穷大时函数的极限
趋于无穷大：自变量绝对值无限增大，不区分正负
定义修改为：对于$\forall \epsilon>0$，$\exists X>0$，当$|x| > X$时，都满足$|f(x) - a| < \epsilon$

函数趋于$\infty$时的极限存在的充要条件是$+\infty$和$-\infty$的极限都存在且相等

### 1.2.4 数列的极限
数列是定义在正整数集$Z^+$上的函数

### 1.2.5 无穷小与无穷大
函数$a(x)$在$x$的某种趋向下以0为极限，$a(x)$即为$x$在该趋向下的无穷小
无穷小是变量，不是常量

上述改成函数在某种趋向下绝对值无限增大，函数就是该趋向下的无穷大

在同一个变化过程中，无穷大的倒数是无穷小，无穷小的倒数是无穷大

## 1.3 极限的性质与运算
### 1.3.1 极限的几个性质
(1) 极限与函数值的关系
局部有界性
$x_0$处的极限存在时，函数在$x_0$处的某去心领域内有界

局部保号性

唯一性

(2) 函数极限与无穷小的关系
$\lim_{x \to x_0} f(x) = a$的充要条件是$f(x) = a + a(x)$，其中$a(x)$是$x\to x_0$的无穷小

(3) 无穷小的性质
有限个无穷小的和是无穷小

有界函数与无穷小的积是无穷小
推论：常量与无穷小之积是无穷小，有限个无穷小之积是无穷小

### 1.3.2 极限的四则运算法则
(1) $\lim_{x \to x_0} [f(x) \pm g(x)] = \lim_{x \to x_0} f(x) \pm \lim_{x \to x_0} g(x)$
可以推广到有限个函数相加

(2) $\lim_{x \to x_0} [f(x)g(x)] = \lim_{x \to x_0} f(x) \times \lim_{x \to x_0} g(x)$
可以推广到有限个函数相乘
推论：
$\lim_{x \to x_0} [kf(x)] = k\lim_{x \to x_0} f(x)$
$\lim_{x \to x_0} [f(x)]^n = [\lim_{x \to x_0} f(x)]^n$

(3) $$\lim_{x \to x_0} \frac {f(x)} {g(x)} = \frac {\lim_{x \to x_0} f(x)} {\lim_{x \to x_0} g(x)}$$
要求$\lim_{x \to x_0} g(x) \neq 0$

因此极限运算是满足线性性质的

推论：求多项式$P_n(x) = a_0x^n + \cdots + a_{n-1}x + a_n$在$x \to x_0$时的极限时，只要将$x_0$代入即可

### 1.3.3 函数极限与数列极限的关系
海涅定理：
$\lim_{x \to x_0} f(x) = a$的充要条件是对于任意的以$x_0$为极限的数列${x_n}$，$x_n \neq x_0$，都有$f(x_n) \to a(n \to \infty)$

可用于证明$sin \frac 1 x$的极限不存在

### 1.3.4 夹逼法则
在$x_0$的某去心邻域内，有$g(x) \leqslant f(x) \leqslant h(x)$，且$\lim_{x \to x_0} f(x) = \lim_{x \to x_0} h(x) = a$，则$\lim_{x \to x_0} f(x) = a$

应用：
$0 \leqslant |sinx| \leqslant |x|$，易知$\lim_{x \to 0} |sinx| = 0$，因此$\lim_{x \to 0} sinx = 0$
当$0 \lt x \lt \frac\pi 2$时，有$sinx \lt x \lt tanx$，因此$1 \lt \frac x {sinx} \lt \frac 1 {cosx}$，即$$cosx\lt \frac {sinx} x \lt 1$$
而该不等式在$-\frac \pi 2 \lt x \lt 0$时也成立
因此$$\lim_{x \to 0} {\frac {sinx} x } = 1$$
称其为第一个重要极限

### 1.3.5 复合运算法则
$u = \phi(x), y=f(u),\lim_{x\to x_0} \phi(x) = u_0$，且在$x_0$的某去心邻域内$\phi(x) \neq u_0$，$\lim_{u \to u_0} f(u) =  a$
那么有：$\lim_{x\to x_0}f(\phi(x)) = \lim_{u\to u_0}f(u) = a$

极限的复合运算法则实际上是一种变量替换法

## 1.4 单调有界原理和无理数e
### 1.4.1 单调有界原理
若单调增加数列$\{u_n\}$有上界，即$\exists M\quad u_n \le M(n=1,2,\cdots)$，则$\lim_{n\to \infty} u_n$存在且不大于$M$
若单调减小数列$\{u_n\}$有下界，即$\exists m\quad u_n \ge m(n=1,2,\cdots)$，则$\lim_{n\to \infty} u_n$存在且不小于$m$

该定理可用于判断某些数列极限存在性

### 1.4.2 第二个重要极限
数列极限：
$$\lim_{n\to \infty}{(1+\frac 1 n)}^n = e$$
数列极限说明了有理数集合对于极限运算是不封闭的，极限运算必须在实数集合内实施

结合数列极限和夹逼法则，可以解出函数极限
函数极限：
$$\lim_{x\to \infty}{(1+\frac 1 x)}^x = e$$

另一种形式：
$$\lim_{x\to 0}{(1+x)}^{\frac 1 x} = e$$

都是1的无穷次幂的形式

### 1.4.3 指数函数，对数函数，双曲函数
e不是任何一个有理系数代数方程的根，即是一个超越数

双曲函数由$e^x$和$e^{-x}$构成
双曲正弦函数：$$sinhx = \frac {e^x - e^{-x}} 2$$
双曲余弦函数：$$coshx = \frac {e^x + e^{-x}} 2$$
双曲正切函数：$$tanhx = \frac {sinhx} {coshx} = \frac {e^x - e^{-x}} {e^x + e^{-x}}$$

$cosh^2x - sinh^2x = 1$
$sinh2x = 2coshxsinhx$

## 1.5 无穷小的比较
### 1.5.1 无穷小的阶
为了比较同一变化过程中两个无穷小趋于0的快慢，引入无穷小的阶的概念，注意一定要在自变量的同一变化过程中比较

对于两个处于同一变化过程的无穷小$\alpha(x),\beta(x)$
若$$\lim \frac {\alpha(x)}{\beta(x)} = 0$$称$\alpha(x)$是比$\beta(x)$高阶的无穷小，即$\alpha = o(\beta)$

若$$\lim \frac {\alpha(x)}{\beta(x)} = c(c\neq0，为常数)$$称$\alpha(x)$是与$\beta(x)$同阶的无穷小，若$c=1$，则称为等价无穷小，$\alpha \sim \beta$

若$$\lim \frac {\alpha(x)}{\beta^k(x)} = c(c\neq0，为常数)$$称$\alpha(x)$是比$\beta(x)$的$k$阶无穷小

$x\to 0$时
$sinx \sim x \sim tanx$
$1-cosx \sim \frac 1 2 x^2$
$arcsinx \sim x \sim arctanx$
$\sqrt[n]{1+x}-1\sim \frac 1 n x$

$\alpha$和$\beta$是等价无穷小的充要条件是$\alpha = \beta + o(\beta)$，即$\alpha-\beta = o(\beta)$
称$\beta$是$\alpha$的主要部分

高阶无穷小的性质：
$o(x^n) + o(x^m) = o(x^n)(x\to 0)$，其中$m\gt n \gt 0$
$o(x^n) \cdot o(x^m) = o(x^{n+m})(x\to 0)$，其中$m,n \gt 0$

### 1.5.2 利用等价无穷小代换求极限
有无穷小$\alpha,\alpha',\beta,\beta'$，且$\alpha\sim\alpha',\beta\sim\beta'$，若$$\lim{\frac {\beta'}{\alpha'}}$$存在，则$$\lim{\frac\beta\alpha}=\lim{\frac\beta\beta' \frac{\beta'}{\alpha'} \frac {\alpha'}\alpha} = \lim\frac {\beta'}{\alpha'}$$
若$$\lim{\frac {\beta'g(x)}{\alpha'h(x)}}$$存在，则$$\lim{\frac{\beta g(x)}{\alpha h(x)}}=\lim{\frac\beta\beta' \frac{\beta' g(x)}{\alpha' h(x)} \frac {\alpha'}\alpha} = \lim\frac {\beta' g(x)}{\alpha' h(x)}$$

## 1.6 函数的连续与间断
### 1.6.1 函数的连续与间断
自变量的增量$\Delta x = x_1 - x_0$
函数的相应增量$\Delta y = f(x_1) - f(x_0)$

若函数在$x_0$处的某邻域内有定义，当$x$在$x_0$处的增量趋于0时，函数的相应增量也趋于0，即$$\lim_{\Delta x \to 0}\Delta y = 0$$
$$\lim_{\Delta x \to 0}[f(x_0+\Delta x)-f(x_0)] = 0$$
$$\lim_{x\to x_0}f(x) = f(x_0)$$
称函数在$x_0$点处连续

连续函数的图形是一段连续不断的曲线

多项式函数和有理分式函数在定义域内处处连续
$sinx,cosx$在定义域内处处连续

$f(x)$在$x_0$处连续的充要条件是$f(x)$在$x_0$处即左连续又右连续

若$x_0$不是$f(x)$的连续点，则称其为间断点

### 1.6.2 初等函数的连续性
(1) 连续函数的和差积商的连续性
$f(x),g(x)$均为连续函数，则$f(x),g(x)$的和差积商(分母不为0)也是连续函数

(2) 反函数的连续性
$y = f(x)$在$I$上单调且连续，值域为$I'$，则$x = f^{-1}(y)$在$I'$上单调且连续，值域为$I$

(3) 复合函数的连续性
$u = \phi(x)$在$x_0$处连续，$u_0 = \phi(x_0)$，$y = f(u)$在$u_0$处连续
则$$\lim_{x\to x_0}f(\phi(x)) = \lim_{u\to u_0}f(u) = f(u_0) = f(\phi(x_0))$$即复合函数$f(\phi(x))$在$x_0$处连续

$$\lim_{x\to x_0}f(\phi(x)) = \lim_{u\to u_0}f(u) = f(u_0) = f(\phi(x_0)) = f(\lim_{x\to x_0}\phi(x))$$
说明了对于连续函数，极限符号和函数符号可以交换次序

推广：
函数$y = f(u), u = \phi(x)$，若$x\to x_0$时，$u\to u_0$，(注意并不要求$u = \phi(x)$连续，只要求在$x_0$处的极限存在，且极限值为$u_0$，$\phi(x_0)$并不必要等于$u_0$)，而$y = f(u)$在$u_0$处连续
则复合函数$y = f(\phi(x))$在$x\to x_0$时的极限存在，且为$f(u_0)$
即$$\lim_{x\to x_0}f(\phi(x)) = \lim_{u\to u_0}f(u) = f(u_0) = f(\lim_{x\to x_0}\phi(x))$$

应用：
$$\lim_{x\to 0} {\frac {log_a(x+1)}{x}} = \frac 1 {ln a}$$
$$\lim_{x\to 0}\frac {a^x -1}{x} = lna$$
令$a = e$，可以知道$ln(x+1) \sim x \sim e^x -1$
$$\lim_{x\to 0}{\frac {(x+1)^a -1}{x}} = a(a\ne 0)$$
可以知道$(x+1)^a -1 \sim ax$


(4) 初等函数的连续性
基本初等函数(幂函数、指数函数、对数函数、三角函数、反三角函数)在各自的定义域内都是连续的，根据之前提到的原则，一切初等函数在其定义域内都是连续的

因此对于一个初等函数$f(x)$，$\lim_{x\to x_0} f(x) = f(x_0)$

## 1.7 闭区间上连续函数的性质
### 1.7.1 闭区间上连续函数的有界性和最值性质
$f(x)$在$[a,b]$上连续，则$f(x)$在$[a,b]$上存在最大值$f(\xi_1)$和最小值$f(\xi_2)$，对于$\forall x \in [a,b],f(\xi_1)\leqslant f(x) \leqslant f(\xi_2)$，则$f(x)$在$[a,b]$上有界
($f(x)$在$(a,b)$上连续，且$f(a+0)$存在，即左端点的右极限存在，且$f(b-0)$存在，即右端点的左极限存在，则$f(x)$在$[a,b]$上有界)

最大值与最小值定理：闭区间上的连续函数在该区间上一定有界且一定有最大值和最小值

### 1.7.2 闭区间上连续函数的介值性质
零点定理：$f(x)$在$[a,b]$上连续，且$f(a),f(b)$异号，则$(a,b)$存在一点$\xi$，使得$f(\xi) = 0$，即方程$f(x) = 0$在$(a,b)$内至少有一个实根

任何实系数奇数次多项式方程必有实根

应用：二分法求方程近似解
思想即从$(a,b)$开始，不断将区间二等分，确认$f(x) = 0$的根所在的区间，以不断缩小方程$f(x) = 0$的根所处于的区间，可以将误差任意缩小

介值定理：$f(x)$在$[a,b]$上连续，$f(a)\neq f(b)$，对于介于$a,b$之间的任意实数$u$，$\exists \xi \in (a,b), f(\xi) = u$
介值定理告诉我们闭区间上的连续函数可以取到它的最大值和最小值之间的一切值

### 1.7.3 函数的一致连续性
函数在$x_0$处连续，即对于$\forall \epsilon>0,\exists \delta>0,当|x-x_0|<\delta,|f(x)-f(x_0)|<\epsilon$
函数在某个区间上连续即函数在区间内的所有点上都连续
一般来说，对于不同的$x_0$，同样的$\epsilon$，要满足$|f(x)-f(x_0)|<\epsilon$，会有不同的$\delta$
即$\delta$不仅与$\epsilon$有关，还与$x_0$有关

当$\delta$只与$\epsilon$有关时，可以这样表示：
定义于$I$上的$f(x)$，对于$\forall \epsilon > 0, \exists \delta > 0$，对于$\forall x_1,x_2 \in I,当|x_1 - x_2| < \delta, |f(x_1) -f(x_2)|<\epsilon$
即$f(x)$在$I$上一致连续

能找到一个公共的$\delta$，无论$x_1,x_2$出现在何处，只要$x_1,x_2$接近到一定的尺度$\delta$，二者函数值的误差能小于预定的精度$\epsilon$

连续性是逐点刻画了函数的性态，是局部性概念，区间连续是局部性概念的总和
一致连续是整体刻画函数的性态，是整体性概念

一致连续一定连续，反之不然

康托定理：若函数在闭区间上连续，则函数在该区间上一致连续

# 2 一元函数微分学及其应用
## 2.1 导数的概念
### 2.1.1 变化率问题举例
割线斜率的极限$\to$切线斜率

### 2.1.2 导数的概念
$y = f(x)$在$x_0$的某个邻域内有定义，若$$\lim_{\Delta x \to 0}{\frac {\Delta y} {\Delta x}}$$
存在，称$f(x)$在$x_0$处可导，且该极限为$f(x)$在$x_0$处的导数
$$f'(x_0) = \lim_{\Delta x\to 0}{\frac {\Delta y}{\Delta x}} = \lim_{\Delta x \to 0}{\frac {f(x_0+\Delta x)-f(x_0)}{\Delta x}} = \lim_{x \to x_0}{\frac {f(x)-f(x_0)}{x-x_0}}$$
若该极限不存在，则称$f(x)$在$x_0$处不可导，若极限为无穷，则称导数为无穷大

导数是函数变化率的精确描述，反映了因变量随自变量变化的快慢程度

若$f(x)$在开区间$I$每点处都可导，则称函数在开区间$I$内可导，对于$\forall x \in I$，$x$对应一个确定的导数值，如此定义了以$I$为定义域的新函数，称其为$y = f(x)$在$I$内的导函数，记为$y',f'(x),\frac {dy} {dx}, \frac {df(x)}{dx}$

某点处导数存在的充要条件是左导数和右导数存在且相等

### 2.1.3 用定义求导数举例
三步：求增量$\Delta y$，算比值$\frac {\Delta y}{\Delta x}$，取极限$\lim_{\Delta x\to 0}{\frac {\Delta y}{\Delta x}}$

### 2.1.4 导数的几何意义
$y = f(x)$在$x_0$处的导数$f'(x_0)$即为曲线$y = f(x)$在点$M(x_0,f(x_0))$处的切线的斜率
切线方程为：$y-f(x_0) = f'(x_0)(x-x_0)$

若$f'(x_0) = \infty$，该切线垂直于x轴，切线方程$x = x_0$

过切点$M(x_0,f(x_0))$垂直于切线的直线为$y=f(x)$在$M$处的法线
当$f'(x_0)\neq 0$，法线方程为：$y-f(x_0) = -\frac {1} {f'(x_0)}(x-x_0)$

### 2.1.5 函数可导性与连续性的关系
可导必连续：$y=f(x)$在$x_0$处可导，即$\lim_{\Delta x \to 0}{\frac {\Delta y}{\Delta x}} = f'(x_0)$存在，即$\frac {\Delta y}{\Delta x} = f'(x_0) + \alpha$，$\alpha$是$\Delta x \to 0$时的无穷小，故$\Delta y = f'(x_0)\Delta x + \alpha \Delta x$，则$\Delta x \to 0$时，有$\Delta y \to 0$

连续不一定可导，如$f(x) = |x|$

连续是可导的必要条件，不是充分条件

## 2.2 求导法则
利用求导法则和简单函数的导数，可以求出任意初等函数的导数

### 2.2.1 函数的和、差、积、商的求导法则
导数的四则运算：
$u = u(x), v = v(x)$在点$x$处具有导数，则它们的和差积商在$x$处也具有导数：
和差：$(u \pm v)' = u' \pm v'$
积：$(uv)' = u'v + uv',(cu)' = cu'$($c$为常数)
商：$(\frac u v)' = \frac {u'v - uv'} {v^2}(v \ne 0), (\frac 1 v)' = -\frac{v'} {v^2}$

和差、积推广到有限个可导函数的和、差、积：
$u_1 \pm u_2 \pm \cdots \pm u_n = u_1' \pm u_2' \pm \cdots \pm u_n'$
$u_1u_2\cdots u_n = u_1'u_2\cdots u_n + u_1u_2'\cdots u_n + \cdots u_1u_2\cdots u_n'$

应用：
$$y = \tan x, y' = (\frac {\sin x} {\cos x})' = \frac 1 {\cos^2 x} = \sec^2 x$$
$$y = \cot x,y' = (\frac {\cos x}{\sin x})' = \frac {-1}{\sin^2 x} = -\csc^2 x$$
$$y = \sec x,y' = (\frac 1 {\cos x})' = \frac {\sin x}{\cos^2 x} = \sec x\tan x$$
$$y = \csc x,y' = (\frac 1 {\sin x})' = -\csc x\cot x$$

### 2.2.2 复合函数的求导法则
链式法则：
$u = g(x)$在$x$处可导，$y = f(u)$在$u = g(x)$处可导，则$y = f(g(x))$在$x$处可导
$$\frac {dy}{dx} = f(u)'\cdot g(x)' = \frac {dy}{du}\frac {du}{dx}$$
说明复合函数对自变量的导数等于它对中间变量的导数乘以中间变量对自变量的导数

可以将此法则推广到有限次复合的函数上去

应用：
$\sinh x' = \cosh x$
$\cosh x' = \sinh x$

### 2.2.3 反函数的求导法则
反函数求导法则：
$x = f(y)$在$I_y$内单调可导且$f'(y) \ne 0$，则其反函数$y = f^{-1}(x)$在对应区间$I_x = \{x | x = f(y),y\in I_y\}$内也可导
$$y' = [f^{-1}(x)]' = \frac 1 {f'(y)}$$或
$$\frac {dy}{dx} = \frac 1 {\frac {dx}{dy}}$$

说明反函数的导数等于直接函数的导数的倒数

从几何上看，反函数和直接函数的图形是同一条曲线，设曲线上处处有切线，过曲线上一点$M(x,y)$作切线，该切线与$x$轴，$y$轴的夹角分别是$\alpha$，$\beta$，显然$$\tan \alpha = \cot \beta = \frac 1 {\tan \beta}$$

应用：
$$x = \sin y(-\frac \pi 2 \leqslant y \leqslant \frac \pi 2), y = \arcsin x(-1 \leqslant x \leqslant 1)$$
则$$y' = (\arcsin x)' = \frac 1 {\sqrt{1-x^2}}(-1 \leqslant x \leqslant 1)$$同理
$$y' = (\arccos x)' = - \frac 1 {\sqrt {1-x^2}}(-1\leqslant x\leqslant 1)$$


$$x = \tan y(-\frac \pi 2 \leqslant y \leqslant \frac \pi 2), y = \arctan x(-\infty \lt x \lt \infty)$$
则$$y' = (\arctan x)' = \frac 1 {1+x^2}(-\infty \lt x \lt \infty)$$
同理
$$y' = (arccot x)' = -\frac 1 {1+x^2}(-\infty \lt x \lt \infty)$$

利用已经求出的基本初等函数的导数，以及导数的运算法则，原则上可以求出任何一个初等函数的导数

可导的初等函数的导数一般仍为初等函数

### 2.2.4 一些特殊的求导法则
(1) 隐函数求导法则
函数关系的两种描述方式
显函数：$y = f(x)$，初等函数都可以用显函数表示
隐函数：$F(x,y) = 0$，由方程确定的函数

在所给定的方程已确定了隐函数的条件下，隐函数求导的一般方法：
将$y$替换为$y(x)$，等式两边同时对$x$求导，解出$y'$或$\frac {dy}{dx}$

即只要记住$x$是自变量，$y$是$x$的函数，而$y$的函数是$x$的复合函数，将方程两边同时对$x$求导，就得到一个含有导数$\frac {dy}{dx}$的方程，从中解出$\frac {dy}{dx}$即可，一般隐函数的导数的表达式中会同时含有变量$x$和$y$

应用：
对于一般的幂指函数$y = [u(x)]^{v(x)}$求导时，一般先取对数得$\ln y = v(x)\ln {u(x)}$，再利用隐函数求导法进行求导，此即对数求导法
对含有多个因式相乘除，带有乘方、开方得函数求导时，也常用这一方法

(2) 参数式函数求导法
设$x = \phi(t),y = \psi(t)$均可导，且$\phi'(t)\ne 0$，$x = \phi(t)$有单调的反函数$t = \phi^{-1}(x)$，则由参数方程$\begin{cases}x = \phi(t) \\ y = \psi(t)\end{cases}$所确定的函数$y = y(x)$，可以看成是由$y = \psi(t)$以及$t = \phi^{-1}(x)$复合而成的函数$y = \psi(\phi^{-1}(x))$
故$$\frac {dy}{dx} = \frac {dy}{dt}\frac {dt}{dx} = \frac {\frac {dy}{dt}}{\frac {dx}{dt}}$$
即$$\frac {dy}{dx} =\frac {\psi'(t)} {\phi'(t)}$$

(3) 极坐标方程的求导法则
曲线方程以$r = r(\theta)$的极坐标形式给出
利用直角坐标与极坐标之间的关系，先将其化为参数方程$$\begin{cases}x = r\cos\theta = r(\theta)\cos\theta \\
y = r\sin \theta = r(\theta)\sin\theta\end{cases}$$
然后利用参数方程求导方法即可
$$\frac {dy}{dx} = \frac {\frac {dy}{d\theta}}{\frac {dx}{d\theta}}$$

注意曲线的切线斜率一定是$y$对$x$的变化率，不是$r$对$\theta$的变化率，因此$r'(\theta_0)$不是曲线在对应$\theta = \theta_0$时的切线斜率

## 2.3 高阶导数与相关变化率
### 2.3.1 高阶导数
若$y = f(x)$的导数$y' = f'(x)$仍是$x$的可导函数，则称$y' = f'(x)$对$x$的导数为$y = f(x)$的二阶导数，记为$y'' = \frac {d^2y}{dx^2}$，即$y'' = (y')'$，或$\frac {d^2y}{dx^2} = \frac d {dx}\frac {dy}{dx}$
可以类似定义到$n$阶导数，记成$y^{(n)}$或$\frac {d^{n}y}{dx^n}$
若函数具有$n$阶导数，称其$n$阶可导

应用：
$y = e^x, y^{(n)} = e^x$
$y = a^x(a \gt 0, a\ne 1),y^{(n)} = a^x (lna)^n$
$y = \sin x, y^{(n)} = \sin(x + n\cdot\frac \pi 2)$
$y = \cos x, y^{(n)} = \cos(x + n\cdot\frac \pi 2)$
$y = \ln(1+x)(x \gt -1), y^{(n)} = (-1)^{n-1}\frac {(n-1)!}{(1+x)^n}$
$y = x^u, y^{(n)} = u(u-1)(u-2)\cdots(u-n+1)x^{u-n}$
特别地：$(x^n)^{(n)} = n!, (x^n)^{(n+1)} = 0$

可以证明如下求导法则成立：
$(u\pm v)^{(n)} = u^{(n)} \pm v^{(n)}$
$(cu)^{(n)} = cu^{(n)}$($c$为常数)
$(uv)^{(n)} = \sum_{k = 0}^n C_n^ku^{(n-k)}v^{(k)}$，其中规定$v^{(0)} = v,u^{(0)} = u$，此即莱布尼茨公式

参数方程$\begin{cases}x=\phi(t)\\ y = \psi(t)\end{cases}$所确定的函数$y=f(x)$，若$x=\phi(t),y=\psi(t)$具有二阶导数，则$y=f(x)$的二阶导数为$$\frac {d^2y}{dx^2}=\frac {d\frac {dy}{dx}}{dx} = \frac{\frac d {dt} {[\frac {\psi'(t)}{\phi'(t)}]}}{\phi'(t)}=\frac {\phi'\psi''-\psi'\phi'}{\phi'^3}$$

### 2.3.2 相关变化率
变量$x = x(t),y = y(t),z = z(t)$存在某种数量上的相依关系，那么变化率$\frac {dx}{dt},\frac {dy}{dt},\frac {dz}{dt}$也存在某种数量上的相依关系，这种相互依赖的变化率称为相关变化率

## 2.4 函数的微分与函数的局部线性逼近
导数反映函数在某一点变化的“快慢”程度，即变化率，而微分主要表示函数在某一点的增量(改变量)的近似程度

### 2.4.1 微分的概念
用$\Delta x$的一次函数在局部范围内近似表示$\Delta y$或$f(x)$，称为局部线性逼近的思想

$y = f(x)$在某区间内有定义，$x_0,x_0+\Delta x$在该区间内，若增量$\Delta y = f(x_0 + \Delta x)-f(x_0)$可以表示为$\Delta y = A\Delta x + o(\Delta x)$，其中$A$与$\Delta x$无关，只与$x_0$有关，则称函数$y = f(x)$在点$x_0$处是可微的，而$A\Delta x$称为函数在$x_0$处的相应于自变量增量$\Delta x$的微分，记为$dy$，即$dy = A\Delta x$

显然，函数在$x_0$处的微分$dy = A\Delta x$是函数增量$\Delta y$当$\Delta x \to 0$时的线性主部

若函数$y = f(x)$在$x_0$处可微$$\begin{aligned}\Delta y = & A\Delta x + o(\Delta x) \\\\
\frac {\Delta y}{\Delta x} = &A + \frac {o(\Delta x)}{\Delta x} \\\\
\lim_{\Delta x \to 0}{\frac {\Delta y}{\Delta x}} =& A + \lim_{\Delta x\to 0}{\frac {o(\Delta x)}{\Delta x}}
\end{aligned}$$即$$f'(x_0) = A $$
因此，若函数在$x_0$处可微，则函数在$x_0$处可导，且导数为$A$

若函数$y = f(x)$在$x_0$处可导
$$\begin{aligned}\lim_{\Delta x \to 0}{\frac {\Delta y}{\Delta x}} =& f'(x_0) \\\\
\frac {\Delta y}{\Delta x} =& f'(x_0) + \alpha \\\\
\Delta y =& f'(x_0)\Delta x+\alpha\Delta x\\\\
\Delta y =& f'(x_0)\Delta x + o(\Delta x)
\end{aligned}$$
显然$f'(x_0)$不依赖于$\Delta x$
因此，若函数在$x_0$处可导，则函数在$x_0$处可微

函数在某点可微和可导是等价的，求导法又称微分法

注意函数在某点的微分$dy = f'(x_0)\Delta x$，既与$x_0$有关，又与$\Delta x$有关

通常把自变量的增量$\Delta x$称为自变量的微分$dx$，因此$dy = f'(x)dx$，$\frac {dy}{dx} = f'(x)$，即微商等于导数

### 2.4.2 微分公式与运算法则
(1) 基本初等函数的微分公式
记住$dy = f'(x)dx$即可

(2) 函数和差积商的微分公式
$d(u\pm v) = du\pm dv$
$d(cu) = cdu$($c$为常数)
$d(uv) = udv+vdu$
$d(\frac u v) = \frac {vdu-udv}{v^2}(v\ne 0)$

(3) 复合函数的微分法则
$y = f(u),u = g(x)$均可导，$y = f(g(x))$的微分为
$dy = y_x'dx = f'(u)g'(x)dx$
因为$g'(x)dx = du$
故$dy = f'(u)du = y_u'du$
此即微分形式不变性

### 2.4.3 微分的几何意义及简单应用
(1) 微分的几何意义
对于可微函数$y = f(x)$，当$\Delta y$是曲线在纵坐标上的增量时，$dy$就是曲线的切线在该点处纵坐标相应的增量，在点$M$的临近，我们用切线段代替曲线段
即$f(x) \approx f(x_0) + f'(x_0)(x-x_0)$
函数$f(x)$在$x_0$附近近似表示为关于$x$的一次多项式
此即函数的局部线性逼近，$|\Delta x| = |x-x_0|$越小，精度越高

(2) 微分在近似计算中的应用
我们已知当$f'(x_0)\ne 0$时，函数$y= f(x)$在$x_0$处的微分$dy = f'(x_0)\Delta x$是增量$\Delta y =f(x_0+\Delta x)- f(x_0)$的线性主部($\Delta x \to 0$)
而$$\lim_{\Delta x \to 0}{\frac {\Delta y}{dy}} = \lim_{\Delta x\to 0}{\frac {\Delta y}{f'(x_0)\Delta x}} = \frac 1 {f'(x_0)}\lim_{\Delta x\to 0}{\frac {\Delta y}{\Delta x}} = 1 $$
即当$f'(x_0)\ne 0$时，$\Delta y,dy$是$\Delta x \to 0$时的等价无穷小
当$|\Delta x|$足够小时，可以用微分近似增量$\Delta y \approx dy$

$\Delta y \approx f'(x_0)\Delta x$
$f(x_0+\Delta x) \approx f(x_0)+f'(x_0)\Delta x$
$f(x) \approx f(x_0)+f'(x_0)(x-x_0)$

令$x_0 = 0$，则当$|\Delta x| = |x|$很小时，可得
$\sin x \approx x$
$\tan x \approx x$
$e^x \approx x+1$
$\ln(x+1)\approx x$
$\arctan x \approx x$
$(1+x)^u \approx 1 + ux(u为实数),\sqrt[n]{(1+x)}\approx 1+\frac 1 n x$

(3) 误差估计
精确值$x_0$，近似值$x$
$|\Delta x | = |x-x_0|$为绝对误差
$\frac {|\Delta x|}{|x|}$为相对误差

## 2.5 利用导数求极限——洛必达法则
两个无穷小之比的极限称为$\frac 0 0$型未定式
两个无穷大之比的极限称为$\frac \infty \infty$型未定式

### 2.5.1 零比零型未定式的极限
$\frac 0 0$型未定式的洛必达法则
函数$f(x)$和$g(x)$都在点$x_0$的某去心邻域内有定义，且满足条件
1. $\lim_{x\to x_0}f(x) = \lim_{x\to x_0}g(x) = 0$(零比零型)
2. 在点$x_0$的某去心邻域内，$f'(x),g'(x)$都存在，且$g'(x)\ne 0$(要求导数都存在)
3. $\lim_{x\to x_0}{\frac {f'(x)}{g'(x)}}$存在(或为无穷大)(比值的极限存在)
则有$$\lim_{x\to x_0}{\frac {f(x)}{g(x)}} = \lim_{x\to x_0}{\frac {f'(x)}{g'(x)}}$$
注意如果满足条件，洛必达法则可以连续使用

当$x\to x_0^-,x\to x_0^+$时，零比零型洛必达法则的结论同样成立
当$x\to \infty,x\to -\infty,x \to +\infty$时，零比零型洛必达法则的结论同样成立，可通过变换$x = \frac 1 t$化成$t\to 0,t\to 0^-,t\to 0^+$的情况

### 2.5.2 无穷比无穷型未定式的极限
$\frac \infty \infty$型未定式的洛必达法则
函数$f(x)$和$g(x)$都在点$x_0$的某去心邻域内有定义，且满足条件
1. $\lim_{x\to x_0}f(x) = \lim_{x\to x_0}g(x) = \infty$(无穷比无穷型)
2. 在点$x_0$的某去心邻域内，$f'(x),g'(x)$都存在，且$g'(x)\ne 0$(要求导数都存在)
3. $\lim_{x\to x_0}{\frac {f'(x)}{g'(x)}}$存在(或为无穷大)(比值的极限存在)
则有$$\lim_{x\to x_0}{\frac {f(x)}{g(x)}} = \lim_{x\to x_0}{\frac {f'(x)}{g'(x)}}$$
注意如果满足条件，洛必达法则可以连续使用

当$x\to x_0^-,x\to x_0^+$时，无穷比无穷型洛必达法则的结论同样成立
当$x\to \infty,x\to -\infty,x \to +\infty$时，无穷比无穷型洛必达法则的结论同样成立，可通过变换$x = \frac 1 t$化成$t\to 0,t\to 0^-,t\to 0^+$的情况

### 2.5.3 其他类型未定式的极限
形如$0\cdot \infty,\infty -\infty,0^0,1^\infty,\infty^0$型的未定式，可变形为上述两种形式进行计算

## 2.6 微分中值定理
微分中值定理构架起了函数与导数二者之间的桥梁

### 2.6.1 罗尔定理
费马引理：
$f(x)$在$x_0$处的某邻域$U(x_0)$内有定义，并且在$x_0$处可导，若对$\forall x \in U(x_0)$，有$f(x)\leqslant f(x_0)$或$f(x)\geqslant f(x_0)$，则$f'(x_0) = 0$
直观解释即曲线在高峰和低谷处有切线，而切线是水平的

导数为0的点称为函数的驻点或临界点

罗尔定理是费马引理的直接推论：
$f(x)$在$[a,b]$上连续，$(a,b)$上可导，$f(a) = f(b)$，则至少$\exists \xi \in (a,b)$使得$f'(\xi) = 0$

解释：
在闭区间上连续是保证$f(x)$可以由闭区间上连续函数的性质在$[a,b]$上必取得最大值$M$和最小值$m$，若$f(x)$不恒为常数，必有$M>m$，又$f(a) = f(b)$，因此$M,m$之间至少有一个不等于$f(a),f(b)$，不妨设$M\ne f(a) = f(b)$，则由闭区间上连续函数的性质可以知道存在一点$\xi \in (a,b)$，使得$f(\xi) = M$，由费马引理可得$f'(\xi) = 0$

罗尔定理说明了可微函数的函数值相等的两个点之间至少有一个导函数的零点

### 2.6.2 拉格朗日中值定理
$f(x)$在$[a,b]$上连续，在$(a,b)$上可导，则至少存在一点$\xi \in (a,b)$，使得
$$f'(\xi) = \frac {f(b)-f(a)}{b-a}$$
或
$$f(b)-f(a) = f'(\xi)(b-a)$$

罗尔定理是拉格朗日中值定理在$f(a)=f(b)$时的特殊情况

证明：构造在闭区间上连续，开区间上可导的函数$y = x(f(b)-f(a)) - f(x)(b-a)$
应用罗尔定理即可

$f(b)-f(a) = f'(\xi)(b-a)$称为拉格朗日中值公式，若$f(x)$在以$x_0$和$x_0+\Delta x$为端点的区间上满足拉格朗日定理的条件，则中值公式的形式为
$f(x_0+\Delta x)-f(x_0) = f'(x_0+\theta\Delta x)\Delta x,\theta\in (0,1)$
更直观的形式：$\Delta y = f'(\xi)\Delta x$

推论：
若$f(x)$在区间$(a,b)$内的导数$f'(x)\equiv 0$，则$f(x)$在$(a,b)$内是一个常数
若$f(x),g(x)$在$(a,b)$内可导，并满足$f'(x) = g'(x)$，则在$(a,b)$内$f(x) = g(x) + c$($c$为常数)(因为函数$\phi(x) = f(x)-g(x)$的导函数$\phi'(x)\equiv 0$)

### 2.6.3 柯西中值定理
$f(x),g(x)$在$[a,b]$上连续，在$(a,b)$内可导，且$g'(x)\ne 0$，那么$\exists \xi \in (a,b)$，使得$$\frac {f(b)-f(a)}{g(b)-g(a)} = \frac {f'(\xi)}{g'(\xi)},a<\xi<b$$
证明：构造在闭区间上连续，开区间上可导的函数$$\phi(x) = f(x) - \frac {f(b)-f(a)}{g(b)-g(a)}g(x)$$
应用罗尔定理即可
$g'(x)\ne 0$的条件是保证$g(a)\ne g(b)$，因为$\exists \xi \in (a,b),g(b)-g(a) = g'(\xi)(b-a)$

拉格朗日中值定理是柯西中值定理在$g(x) = x$时的特例

柯西中值定理的直接应用是证明洛必达法则：
$f(x),g(x)$在$x_0$的某去心邻域$U(x_0)\backslash \{x_0\}$内有定义，且满足
1. $\lim_{x\to x_0}f(x) = \lim_{x\to x_0}g(x) = 0$(零比零型)
2. $f'(x),g'(x)$在$U(x_0)\backslash \{x_0\}$内都存在，且$g'(x)\ne 0$(导数都存在)
3. $\lim_{x\to x_0}{\frac {f'(x)}{g'(x)}} = A(或\infty)$(导数的比值的极限存在)
则有$$\lim_{x\to x_0}{\frac {f(x)}{g(x)}} = \lim_{x\to x_0}{\frac {f'(x)}{g'(x)}}$$
作辅助函数
$F(x) = \begin{cases}f(x) &(x\in U(x_0)\backslash \{x_0\}) \\0&(x = x_0)\end{cases}$
$G(x) = \begin{cases}g(x) &(x\in U(x_0)\backslash \{x_0\}) \\0&(x = x_0)\end{cases}$
对$\forall x \in U(x_0)$，在$[x_0,x]$或$[x,x_0]$上，$F(x),G(x)$满足柯西中值定理的条件
由柯西中值定理
$$\lim_{x\to x_0}\frac {f(x)}{g(x)} = \lim_{x\to x_0}\frac {F(x)}{G(x)} = \lim_{x\to x_0} \frac {F(x)-F(x_0)}{G(x)-G(x_0)} = \lim_{\xi\to x_0}\frac {f'(\xi)}{g'(\xi)} = \lim_{x\to x_0}\frac {f'(x)}{g'(x)}$$

## 2.7 泰勒公式——用多项式逼近函数
多项式只包含加法和乘法运算，并在$(-\infty,\infty)$上处处连续，且有任意阶的连续导数，用多项式近似代替函数的方法称为多项式逼近

### 2.7.1 泰勒多项式与泰勒公式
思想：
当$f(x)$在$x_0$处$n$阶可导时，可用$n$次多项式$P_n(x) = a_0 + a_1(x-x_0) + a_2(x-x_0)^2+\cdots+a_n(x-x_0)^n$近似表示$f(x)$
且$P_n(x)$满足$P_n(x_0) = f(x_0),P_n^{(k)}(x_0) = f^{(k)}(x_0)(k=1,2,\cdots,n)$，即在点$x_0$处的各阶导数都相等
容易求得$a_0 = f(x_0),a_k = \frac {f^{(k)}(x_0)}{k!}(k=1,2,\cdots,n)$
且可以证明$R_n(x) = f(x)-P_n(x) = o((x-x_0)^n)$
即$f(x) = P_n(x)+R_n(x)$

泰勒定理：
$f(x)$在$x_0$处$n$阶可导，则当$x\to x_0$时
$$\begin{aligned}f(x) =& P_n(x)+R_n(x)\\
=& a_0 + a_1(x-x_0) + a_2(x-x_0)^2+\cdots+a_n(x-x_0)^n+o((x-x_0)^n)\\
=& f(x_0) + f'(x_0)(x-x_0) + \frac {f''(x_0)}{2!}(x-x_0)^2+\cdots+\\& \frac {f^{(n)}(x_0)}{n!}(x-x_0)^n+o((x-x_0)^n)
\end{aligned}$$
即$f(x)$等于$n$阶泰勒多项式加皮亚诺型余项

泰勒中值定理：
如果$f(x)$在$(a,b)$内具有$n+1$阶导数，$x_0,x\in(a,b)$，且$x_0\ne x$，则在$x_0,x$之间存在一点$\xi$，使得
$$\begin{aligned}f(x) =& P_n(x)+R_n(x)\\
=& a_0 + a_1(x-x_0) + a_2(x-x_0)^2+\cdots+a_n(x-x_0)^n+o((x-x_0)^n)\\
=& f(x_0) + f'(x_0)(x-x_0) + \frac {f''(x_0)}{2!}(x-x_0)^2+\cdots+\\& \frac {f^{(n)}(x_0)}{n!}(x-x_0)^n+\frac {f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}
\end{aligned}$$
$\frac {f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}$为拉格朗日型余项

令$x_0 = 0$,可得$$f(x)= f(0) + f'(0)x + \frac {f''(0)}{2!}x^2+\cdots+ \frac {f^{(n)}(0)}{n!}x^n+\frac {f^{(n+1)}(\theta x)}{(n+1)!}x^{n+1},0<\theta<1$$称其为$f(x)$的麦克劳林公式(在$x = 0$处进行$n$阶多项式展开，余项为拉格朗日形式)

### 2.7.2 常用函数的麦克劳林公式
(1) $f(x) = e^x$
$$e^x = 1 + x + \frac {x^2} {2!} + \cdots + \frac {x^n} {n!} + \frac {e^{\theta x}}{(n+1)!} x^{(n+1)},0<\theta < 1$$

(2) $f(x) = \sin x$
$f^n(x) = \begin{cases} 0&(n=2m)\\(-1)^m&(n = 2m+1)\end{cases}$
$$\sin x = x - \frac {x^3} {3!} + \frac {x^5}{5!}-\cdots +  \frac {(-1)^{m-1}}{(2m-1)!} x^{2m-1}+R_{2m}(x)$$
$$R_{2m}(x)=\frac {\sin [\theta x+(2m+1)\frac \pi 2]}{(2m+1)!}x^{2m+1},0<\theta<1$$

(3) $f(x) = \cos x$
$$\cos x = 1 - \frac {x^2} {2!} + \frac {x^4}{4!}-\cdots +  \frac {(-1)^{m}}{(2m)!} x^{2m}+R_{2m+1}(x)$$
$$R_{2m+1}(x)=\frac {\cos [\theta x+(m+1)\pi]}{(2m+2)!}x^{2m+2},0<\theta<1$$

(4) $f(x)= \ln(x+1)$
$$\ln (x+1) = x - \frac {x^2} {2} + \frac {x^3}{3}-\cdots + (-1)^{n-1} \frac {x^{n}}{n} +R_{n}(x)$$

(5) $f(x)= (x+1)^{a}$
$$(x+1)^{a}=1+ ax + \frac {a(a-1)} {2!}x^2 + -\cdots +\frac {a(a-1)\cdots(a-n+1)}{n!}x^{n} +R_{n}(x)$$
当$a = n$，余项为0，得到牛顿二项展开式

泰勒多项式唯一性定理：函数的泰勒多项式具有唯一性

## 2.8 利用导数研究函数的性态
### 2.8.1 函数的单调性
函数单调性判别准则：设$f(x)$在$(a,b)$内可导
若$(a,b)$内$f’(x) > 0 \Rightarrow f(x)$在$(a,b)$内单调递增
若$(a,b)$内$f’(x) < 0 \Rightarrow f(x)$在$(a,b)$内单调递减
在函数单调区间的个别点上，导数可以为0，即如果$f'(x)$在某个区间非负(或非正)，且使$f'(x) = 0$的点在任何有限的子区间内只有有限多个，那么$f(x)$在该区间仍是单调递增(递减)的

应用：
判断一个函数的单调性时，可以求出是$f'(x) = 0$的点以及函数的不可导点(如果存在的话)，用这些点去分割函数的定义域，在这若干个部分区间确定导数的正负号，判断函数在这些区间上的单调性

### 2.8.2 函数的极值
极值点：$f(x)$在点$x_0$及其附近有定义
若存在$x_0$的某去心邻域$\mathring{U}(x_0)$，使得$\forall x \in \mathring{U}(x_0)$，有$f(x_0) > f(x)$，称点$x_0$为函数$f(x)$的一个极大值点，并称$f(x_0)$为函数的极大值
若存在$x_0$的某去心邻域$\mathring{U}(x_0)$，使得$\forall x \in \mathring{U}(x_0)$，有$f(x_0) < f(x)$，称点$x_0$为函数$f(x)$的一个极小值点，并称$f(x_0)$为函数的极小值
极大值点和极小值点统称为极值点，极大值和极小值统称为极值

极值描述的是函数的局部性态

费马定理说明了若函数可导，且$x_0$是极值点，那么$f'(x_0) = 0$，即$x_0$是函数的驻点，但是驻点不一定是极值点，且函数在不可导点也有可能取得极值，因此称函数的不可导点和驻点为函数的可疑极值点

极值点判断的一阶充分条件：
$f(x)$在$x_0$的某邻域$(x_0-\delta,x_0+\delta)$内连续，在$(x_0-\delta,x_0),(x_0,x_0+\delta)$内可导，$x_0$是函数的驻点和不可导点
若在$(x_0-\delta,x_0)$内$f'(x)<0$，而在$(x_0,x_0+\delta)$内$f'(x)>0$，则$x_0$是函数的极小值点
若在$(x_0-\delta,x_0)$内$f'(x)>0$，而在$(x_0,x_0+\delta)$内$f'(x)<0$，则$x_0$是函数的极大值点
若$f'(x)$在这两个区间不变号，则$x_0$不是极值点

根据一阶充分条件，求函数的极值点可以分为三步：
(1) 求函数的导函数
(2) 求出函数的可疑极值点，即驻点和不可导点
(3) 考虑可疑极值点左右邻域的导数的符号判断其是否为极值点

极值点判断的二阶充分条件：
$f(x)$在$x_0$处二阶可导，且$f'(x_0)=0$，而$f''(x_0)\ne 0$
若$f''(x_0)>0$，函数在$x_0$点取得极小值
若$f''(x_0)<0$，函数在$x_0$点取得极大值

### 2.8.3 函数的最大值与最小值
设函数$f(x)$在$[a,b]$上连续，除有限个点外均可导，并且使导数为0的点也是有限个，根据闭区间上连续函数的性质，函数在区间内必然取得最大值和最小值，并且如果最大值或最小值在$(a,b)$内某点取得，它也一定是极大值或极小值，由于是极值点，那么该点一定是驻点或导数不存在的点
因此，我们要求得函数的最大值点和最小值点，我们可以先求函数在开区间上所有可疑极值点的函数值，再和区间端点的函数值比较，确定其中的最大值点和最小值点 

特殊情况下可以简化求最值的过程：如果函数在闭区间内单调，则端点就是最值点，如果函数在一个区间(有限或无限，开或闭)内只有一个可疑极值点$x_0$，若$f(x_0)$是极大值或是极小值，则也是最大值或最小值

### 2.8.4 函数的凸性与拐点
函数$f(x)$在区间$I$内连续，如果对于任意$x_1,x_2\in I,x_1\ne x_2$，以及任意实数$\lambda \in (0,1)$，总有：
$$f(\lambda x_1 + (1-\lambda x_2)) < \lambda f(x_1) + (1-\lambda)f(x_2)$$
则称$f(x)$是在$I$内的下凸函数，简称为凸函数，或称$f(x)$在$I$内是凸的
如果是总有：
$$f(\lambda x_1 + (1-\lambda x_2)) > \lambda f(x_1) + (1-\lambda)f(x_2)$$
则称$f(x)$是在$I$内的下凹函数，简称为凹函数，或称$f(x)$在$I$内是凹的

若$f(x)$是凸函数，则$f(x)$图形上任意两点之间的弦位于函数弧线的上方，即函数向下凸
若$f(x)$是凹函数，则$f(x)$图形上任意两点之间的弦位于函数弧线的下方，即函数向下凹(向上凸)

判断函数凸性的充分条件：
函数$f(x)$在区间$I$内有二阶导数
如果$f''(x) > 0$，则$f(x)$为区间$I$内的凸函数
如果$f''(x) < 0$，则$f(x)$为区间$I$内的凹函数

证明：
$\forall x_1,x_2 \in I$,$\forall \lambda \in (0,1)$，令$x = \lambda x_1 +(1-\lambda)x_2$，已知$f''(x)>0$
在区间$I$上，由泰勒公式：
$$f(x_1)=f(x)+f'(x)(x_1-x)+\frac {f''(\xi_1)}{2!}(x_1-x)^2>f(x)+f'(x)(x_1-x)$$
其中$\xi_1$在$x_1,x$之间
同理：
$$f(x_2)=f(x)+f'(x)(x_2-x)+\frac {f''(\xi_2)}{2!}(x_2-x)^2>f(x)+f'(x)(x_2-x)$$
其中$\xi_2$在$x_2,x$之间
则：
$$\begin{aligned}\lambda f(x_1)+(1-\lambda)f(x_2)>&\lambda f(x)+\lambda f'(x)(x_1-x)+\\
&(1-\lambda)f(x)+(1-\lambda)f'(x)(x_2-x) \\
=&f(x)-f'(x)x+\lambda f'(x)x_1+(1-\lambda)f'(x)x_2\\
=&f(x)-f'(x)x+f'(x)[\lambda x_1+(1-\lambda)x_2]\\
=&f(x)\\
=&f(\lambda x_1+(1-\lambda)x_2)
\end{aligned}$$
即：
$$\lambda f(x_1)+(1-\lambda)f(x_2)>f(\lambda x_1+(1-\lambda)x_2)$$
则$f(x)$是区间$I$上的凸函数
凹函数的情形类似

若函数$f(x)$在某区间内是凸函数或凹函数，则称该区间是曲线$y=f(x)$的凸区间或凹区间，如果函数$y=f(x)$在经过点$(x_0,f(x_0))$时，凹凸性发生了变化，即点$(x_0,f(x_0))$是曲线凹凸区间的分界点，则称点$(x_0,f(x_0))$是曲线$y=f(x)$的拐点

结合判断函数凹凸性的充分条件，我们可以知道函数的拐点$(x_0,f(x_0))$对应着$f''(x_0)=0$或$f''(x_0)$不存在，可以依据此条件来寻找可疑的拐点

### 2.8.5 曲线的渐近线，函数作图
若连续曲线上的动点沿曲线无限远离原点时，动点与某一直线的距离趋于0，则称此直线为该曲线的一条渐近线

水平渐近线：
$\lim_{x\to \infty}f(x) = b$，则直线$y=b$为曲线$y=f(x)$的一条水平渐近线
铅直渐近线：
$\lim_{x\to x_0}f(x) = \infty$，则直线$x=x_0$为曲线$y=f(x)$的一条铅直渐近线

斜渐近线：
$a\ne 0,y=ax+b$是曲线$y=f(x)$的渐近线，则称其为斜渐近线
如果$y=ax+b$是曲线$y=f(x)$的斜渐近线，则有：
$$\lim_{x\to \infty}[f(x)-(ax+b)] = 0$$
即：
$$\lim_{x\to\infty}[f(x)-ax]=b$$
从而：
$$\lim_{x\to\infty}[\frac {f(x)} x -a]=0$$
即：
$$a = \lim_{x\to \infty}{\frac {f(x)}x}$$
因此，如果极限：$$ \lim_{x\to \infty}{\frac {f(x)}x}= a$$存在
且极限：
$$\lim_{x\to\infty}[f(x)-ax]=b$$
存在
容易知道：$$\lim_{x\to \infty}[f(x)-(ax+b)] = 0$$则$y=ax+b$为$y=f(x)$的渐近线

## 2.9 平面曲线的曲率
### 2.9.1 弧微分
设$L$是一条平面曲线，方程为$y=f(x)$，在$L$上取一定点$A$作为度量弧长的基点，规定$x$增大的方向为$L$的正向，设$M(x,y)$为$L$上任一点，记$\overset{\frown} {AM}$弧长为s，则s是M点横坐标的函数，即$s=s(x)$，显然$s(x)$是$x$的单调增加函数，自变量的增量$\Delta x$与弧长增量$\Delta s$保持同号

若$y=f(x)$具有二阶导数，考虑$$\frac {ds}{dx}$$
在增量$\Delta x$下，$\Delta s=\overset{\frown}{MM'}$，可以证明：
$$\lim_{\Delta x\to0}\frac {|\overline{MM'}|}{|\overset{\frown}{MM'}|}=1$$
即弧长和弦长是$\Delta x\to 0$时的等价无穷小
则：
$$\begin{aligned}
\lim_{\Delta x\to 0}\frac{\Delta s}{\Delta x}&=\lim_{\Delta x\to 0}\left|\frac{\Delta s}{\Delta x}\right|=\lim_{\Delta x\to 0}\left|\frac{\Delta s}{\overline{MM'}}\frac{\overline{MM'}}{\Delta x}\right|\\
&=\lim_{\Delta x\to0}\left|\frac {\overset{\frown}{MM'}}{\overline{MM'}}\right|\lim_{\Delta x\to 0}\left|\frac{\overline{MM'}}{\Delta x}\right|
\\
&=\lim_{\Delta x\to 0}\left|\frac{\overline{MM'}}{\Delta x}\right|\\
&=\lim_{\Delta x\to 0}\frac{\sqrt{(\Delta x)^2+(\Delta y)^2}}{|\Delta x|}\\
&=\lim_{\Delta x\to 0}{\sqrt{1+(\frac {\Delta y}{\Delta x}})^2}\\
&={\sqrt{1+({\frac {dy}{dx}})^2}}
\end{aligned}$$
即：
$$\frac {ds}{dx}={\sqrt{1+({\frac {dy}{dx}})^2}}$$
此即弧长函数$s(x)$的微分，即弧微分
$$ds = \sqrt{1+y'^2}dx$$
当$ds$非负，可以写为：
$$ds = \sqrt{(dx)^2+(dy)^2}$$

当曲线为参数方程$\begin{cases}x=\phi(t)\\y=\psi(t)\end{cases},\alpha\le t\leq \beta$时：
$$ds=\sqrt{\phi'^2(t)+\psi'^2(t)}dt$$
当曲线为极坐标方程$r=r(\theta),\alpha\le t\leq \beta$时：
$$ds=\sqrt{r'^2(\theta)+r^2(\theta)}d\theta$$

### 2.9.2 曲率和曲率公式
曲率用于描述弯曲程度

设曲线$L$上从点$A$到点$M(x,y)$的弧长为$s(x)$，则点$M(x,y)$到点$M'(x+\Delta x,y+\Delta y)$的弧长为$|\Delta s|$，若曲线在点$M'$处的切线的转动角为$|\Delta \alpha|$，则称$$\overline K=\left|\frac {\Delta \alpha}{\Delta s}\right|$$为弧$\overset{\frown}{MM'}$的平均曲率

曲率越大，弧段的弯曲程度就越大

当$\Delta x\to 0$时，即当$M'\to M$时，如果弧$\overset{\frown}{MM'}$的平均曲率的极限存在，称此极限为曲线$L$在点$M$处的曲率：
$$K=\lim_{\Delta s\to0}\left|\frac {\Delta \alpha}{\Delta s}\right|=\left|\frac {d\alpha}{ds}\right|$$

曲线的曲率就是弧长对其倾角的变化率

设曲线方程为$y=f(x)$，且$f(x)$有二阶导数，则在$L$上任一点$M(x,y)$处，
有$tan\alpha=y'$，两边求微分得$sec^2\alpha d\alpha=y''dx$，有$$d\alpha=\frac{y''}{sec^2\alpha}=\frac{y''}{1+tan^2\alpha}dx=\frac{y''}{1+y'^2}dx$$
又因为：
$$ds = \sqrt{1+y'^2}dx$$
故曲线$y=f(x)$在任一点$M(x,y)$的曲率：
$$K = \left|\frac {d\alpha}{ds}\right|=\frac {|y''|}{(1+y'^2)^{3/2}}$$

若曲线由参数方程$\begin{cases}x=\phi(t)\\y=\psi(t)\end{cases}$给出，则：
$$K = \frac {|\phi'(t)\phi''(t)-\phi''(t)
\psi'(t)|}{[\phi'^2(t)+\psi'^2(t)]^{2/3}}$$

对于直线$ax+by+c=0$上的任意一点，因为$y''=0$，故曲率为零
对于半径为$R$的圆$\begin{cases}x=R\cos t\\y=R\sin t\end{cases}$，可知圆上任意一点的曲率均为：
$$K=\frac 1 R$$
即圆周上每一点的弯曲程度都是一样的，圆的曲率与半径成反比

设曲线在某点$M$的曲率为$K\ne 0$，则曲线在这点的弯曲程度和以$\frac 1 K$为半径的圆相同，因此称$\frac 1 K$为曲线在该点处的曲率半径，记作$\rho$，即：
$$\rho = \frac 1 K =\frac {(1+y'^2)^{3/2}}{|y''|}$$
过点$M$作曲线的法线，并在曲线凹向一侧的法线上取一点$C(\xi,\eta)$，使$C$到$M$的距离为$\frac 1 K =\rho$，以$C$为圆心，以$\rho$为半径作一圆，称其为曲线在点$M$处的曲率圆，$C$为曲率中心
曲率圆与曲线在点$M$处游公切线，相同的曲率，相同的弯曲方向，可以用曲率圆弧段近似复杂的小曲线段

# 3 一元函数积分学及其应用
## 3.1 定积分的概念、性质、可积准则
### 3.1.1 定积分问题举例
(1) 曲边梯形的面积
$f(x)$在$[a,b]$上连续，且$f(x)\ge 0$，称由曲线$y = f(x),x = a,x = b,y =0$围成的平面图形为曲边梯形，任何曲线围成的平面图形均可以认为由多个曲边梯形拼接而成，因此求曲边梯形的面积为求平面曲线所围成的图形的面积的关键

求曲边梯形面积的步骤：
- 分划
	在$(a,b)$中任意插入$n-1$个分点使$a = x_0 < x_1 < \cdots < x_{n-1} < x_n = b$
	将$[a,b]$划分成$n$个小区间$[x_{i-1},x_i](i=1,2,\cdots,n)$
	曲边梯形也划分为$n$个小曲边梯形
- 代替
	对于每一个小曲边梯形，用矩形面积近似代替曲边梯形的面积，在$[x_{i-1},x_i]$上任取一点$\xi_i$，用$f(\xi_i)$作为矩形的高，从而近似计算小曲边梯形的面积
	$\Delta S_i = f(\xi_i)\Delta x_i(i = 1,2,\cdots, n)$
	其中$\Delta x_i = x_i - x_{i-1}$
- 求和
	对所有的小曲边梯形面积求和，计算曲边梯形面积的近似值
	$S \approx \sum_{i=1}^n \Delta S_i = \sum_{i = 1}^n f(\xi_i)\Delta x_i$
- 取极限
	记$\lambda = \max_{1\le i \le n}{\Delta x_i}$，显然当$\lambda\to 0$，时，和式$\sum_{i=1}^n \Delta S_i$将无限接近$S$
	故将$\lambda \to 0$时$\sum_{i=1}^n \Delta S_i$的极限规定为曲边梯形的面积
	$S = \lim_{\lambda \to 0} \sum_{i=1}^n f(\xi_i)\Delta x_i$

(2) 非均匀细棒的质量
$x$轴上一个质量分布不均匀的细棒，细棒上点$x$处的线密度为$\rho(x)$(假设$\rho(x)$连续)

求非均匀细棒质量的步骤：
- 分划
	在$(a,b)$中任意插入$n-1$个分点使$a = x_0 < x_1 < \cdots < x_{n-1} < x_n = b$
	将$[a,b]$划分成$n$个小区间$[x_{i-1},x_i](i=1,2,\cdots,n)$
	细棒也划分为$n$个小段
- 代替
	对于每一个小段，近似认为其质量分布是均匀的，在$[x_{i-1},x_i]$上任取一点$\xi_i$，用$\rho(\xi_i)$作为小段的线密度，从而近似计算小段的质量
	$\Delta m_i = \rho(\xi_i)\Delta x_i(i = 1,2,\cdots, n)$
	其中$\Delta x_i = x_i - x_{i-1}$
- 求和
	对所有的小段质量求和，计算细棒质量的近似值
	$m \approx \sum_{i=1}^n \Delta m_i = \sum_{i = 1}^n \rho(\xi_i)\Delta x_i$
- 取极限
	记$\lambda = \max_{1\le i \le n}{\Delta x_i}$，显然当$\lambda\to 0$，时，和式$\sum_{i=1}^n \Delta m_i$将无限接近$m$
	故将$\lambda \to 0$时$\sum_{i=1}^n \Delta m_i$的极限规定为细棒的质量
	$m = \lim_{\lambda \to 0} \sum_{i=1}^n \rho(\xi_i)\Delta x_i$

两个问题的共同特征：
- 所求量和一个区间$[a,b]$以及该区间上的一个函数$f(x)/\rho(x)$有关
- 所求量对区间有可加性，即$[a,b]$上的总量等于各个$[x_{i-1},x_i]$上的部分量的和
- 所求量在每个子区间$[x,x+\Delta x]$上的部分量的近似值是$\Delta x$的线性函数(如$f(x)\Delta x$或$\rho(x)\Delta x$)
- 都是通过求具有相同结构的和式的极限得到答案

### 3.1.2 定积分的概念
$f(x)$在闭区间$[a,b]$上有定义，任取$[a,b]$的一个分划，将其分为$n$个子区间	将$[x_{i-1},x_i](i=1,2,\cdots,n)$，记$\Delta x_i = x_i - x_{i-1}, \lambda = \max_{1\le i \le n}{\Delta x_i}$，在$[x_{i-1},x_i]$上任取一点$\xi_i$，作积分和：
$$S_n = \sum_{i=1}^n f(\xi_i)\Delta x_i$$
如果不论对$[a,b]$采用何种分划，不论在$[x_{i-1},x_i]$上如何选区$\xi_i$，当$\lambda \to 0$，$S_n$以同样的一个常数$I$为极限，则称$f(x)$在$[a,b]$上可积，称$I$为$f(x)$在$[a,b]$上的定积分，记为$\int_a^bf(x)$
$$\int_a^bf(x)dx = \lim_{\lambda\to 0}\sum_{i=1}^nf(\xi_i)\Delta x_i$$
被积函数：$f(x)$
被积表达式：$f(x)dx$
积分变量：$x$
积分区间：$[a,b]$
积分上下限：$a,b$
积分符号：$\int$

当$a>b$时，$\Delta x_i <0$，规定
$$\int_a^bf(x)dx = - \int_b^af(x)dx$$
当$a=b$时，规定
$$\int_a^b f(x)dx = 0$$
注意：
1. 定积分是一个数，其值决定于积分区间$[a,b]$，被积函数$f(x)$，与积分变量的记号无关
	如$\int_a^bf(x)dx = \int_a^b f(t)dt = \int_a^b f(u)du$
2. 定积分是一个极限，是和式$\sum_{i=1}^n f(\xi_i)\Delta x_i$的极限，该极限一旦存在，与区间的分划和$\xi_i$的选取无关
	如果由于分划点$x_i$或小区间上$\xi_i$的选法不同导致极限不同或不存在，则函数在该区间上不可积
	如迪利克雷函数$D(x) = \begin{cases} 1 \quad x为有理数 \\ 0 \quad x为无理数\end{cases}$
	在任何有界闭区间$[a,b]$上不可积，$\xi_i$选取有理点或无理点或改变和式的极限的值

### 3.1.3 定积分的几何意义
$f(x)$在$[a,b]$上连续
若$f(x)\ge 0$，则$\int_a^b f(x)dx$为曲线$y = f(x),x = a,x = b,y =0$围成的曲边梯形的面积
若$f(x)$有时取正有时取负，则$\int_a^b f(x)dx$为曲边梯形在$x$轴上方部分的面积减去$x$轴下方部分的面积

### 3.1.4 可积准则
可积的必要条件：
若$f(x)$在$[a,b]$上可积，则$f(x)$在$[a,b]$上必有界

证明：设$f(x)$在$[a,b]$上可积
若$f(x)$在$[a,b]$上无界，对于任意给定的分划$a = x_0 < x_1 < \cdots < x_{n-1} < x_n = b$
可知$f(x)$至少在其中的一个子区间$[x_{j-1},x_j]$上无界，在$[x_{i-1},x_i](i=1,\cdots n,i\ne j)$上任意选取$\xi_i$，在$[x_{j-1},x_j]$上适当选取$\xi_j$
使得$\forall N >0, |f(\xi_j)\Delta x_j| > N + |\sum_{i\ne j}f(\xi_i)\Delta x_i|$
则$$|\sum_{i=1}^nf(\xi_i)\Delta x_i| = |f(\xi_j)\Delta x_j + \sum_{i\ne j}f(\xi_i)\Delta x_i|\ge |f(\xi_j)\Delta x_j| -| \sum_{i\ne j}f(\xi_i)\Delta x_i|>N$$
即对于任意分划$\Delta$，总是可以通过适当选取$\xi_i$使得$|S_n(f;\Delta)|$任意大，因此积分和在$\lambda \to 0$时的极限不存在，即$f(x)$在$[a,b]$上不可积，与假设矛盾
因此$f(x)$在$[a,b]$上必有界

由此定理可知凡是无界函数均不可积
但这只是可积的必要条件，有界函数也可能不可积，如迪利克雷函数

可积的充分条件：
若$f(x)$在$[a,b]$上满足下列条件之一
- $f(x)$在$[a,b]$上连续
- $f(x)$在$[a,b]$上有界，且只有有限个间断点
- $f(x)$在$[a,b]$上单调
则$f(x)$在$[a,b]$上可积

### 3.1.5 定积分的性质
线性运算规则：
$f(x),g(x)$都在$[a,b]$上可积，则对任意常数$\alpha,\beta$，函数$\alpha f(x) + \beta g(x)$在$[a,b]$上也可积，且：$$\int_a^b [\alpha f(x) + \beta g(x)]dx = \alpha\int_a^b f(x)dx + \beta \int_a^b g(x)dx$$
证明：
任取$[a,b]$的一个分划$a = x_0 < x_1 < \cdots < x_{n-1} < x_n = b$，在$[x_{i-1},x_i](i=1,\cdots n)$上任意选取一点$\xi_i$，记$\Delta x_i = x_i - x_{i-1}$，$\lambda = \max_{1\le i \le n} \Delta x_i$
，则相应的积分和：$$\sum_{i=1}^n[\alpha f(\xi_i)+\beta g(\xi_i)]\Delta x_i = \alpha\sum_{i=1}^nf(\xi_i)\Delta x_i+\beta\sum_{i=1}^ng(\xi_i)\Delta x_i$$
由于$f(x),g(x)$可积，等号右端两项在$\lambda\to 0$时分别以$\alpha\int_a^b f(x)dx$和$\beta\int_a^bg(x)$为极限，故等号左端在$\lambda\to0$时的极限存在，即函数$\alpha f(x) + \beta g(x)$在$[a,b]$上可积，且$\int_a^b [\alpha f(x) + \beta g(x)]dx = \alpha\int_a^b f(x)dx + \beta \int_a^b g(x)dx$

因此计算较复杂函数的极限时，可以分项计算

由定积分的定义，可以得到这些性质：
- 若在$[a,b]$上$f(x)\equiv 1$，则$\int_a^b 1dx = \int_a^b dx = b-a$

- 若$f(x)$在$[a,b]$上可积，且$f(x)\ge 0$，则$\int_a^b f(x)dx \ge 0$

- 单调性：若$f(x),g(x)$在$[a,b]$上均可积，且$f(x) \le g(x)$，则$\int_a^b f(x)dx \le \int_a^b g(x)dx$ 
	证明：
	可知函数$g(x) - f(x)$在$[a,b]$上可积，且$g(x)-f(x)\ge 0$，
	故$\int_a^b [g(x) - f(x)]dx = \int_a^b g(x)dx - \int_a^b f(x)dx \ge 0$，
	故$\int_a^b g(x)dx \ge \int_a^b f(x)dx$

- 若$f(x)$在$[a,b]$上可积，且$M,m$分别是$f(x)$在$[a,b]$上的最大值和最小值，则$m(b-a)\le \int_a^b f(x)dx \le M(b-a)$
	证明：
	在$[a,b]$上，$f(x)\ge m$，则$\int_a^b f(x)dx \ge \int_a^b mdx = m\int_a^b dx = m(b-a)$
	同理$\int_a^b f(x)dx \le \int_a^b Mdx = M\int_a^b dx = M(b-a)$

- 若$f(x)$在$[a,b]$上可积，则$|f(x)|$在$[a,b]$上也可积，且$\left | \int_a^b f(x)dx \right | \le \int_a^b |f(x)|dx$
	证明：
	可积性证明较复杂，从略
	由于$-|f(x)|\le f(x) \le |f(x)|,x\in[a,b]$
	故$-\int_a^b|f(x)|dx \le \int_a^b f(x)dx \le \int_a^b |f(x)|dx$
	即$\left | \int_a^b f(x)dx \right | \le \int_a^b |f(x)|dx$

这些性质常用于比较定积分的大小和估计定积分的大致范围

对区间的可加性：
若$f(x)$在$[a,b]$上可积，$c\in(a,b)$，则$f(x)$在$[a,c],[c,b]$上也可积，且$$\int_a^bf(x)dx = \int_a^cf(x)dx + \int_c^bf(x)dx$$
证明：
在子区间上可积性显然，下证可加性
因为$f(x)$在$[a,b]$上可积，因此积分和与分划方式无关，故总可以将$c$作为一个分划点，那么$f(x)$在$[a,b]$上的积分和就等于$f(x)$在$[a,c]$上和$[c,b]$上的积分和，即$$\sum_{i=1}^nf(\xi_i)\Delta x_i=\sum_{[a,c]}f(\xi_i)\Delta x_i+\sum_{[c,b]}f(\xi_i)\Delta x_i$$
令$\lambda\to 0$，取积分和的极限，证毕

由此，计算分段表示的可积函数的定积分时，可以分段计算

将结论进行推广，不论$a,b,c$的相对位置如何，总有$$\int_a^bf(x)dx = \int_a^cf(x)dx + \int_c^bf(x)dx$$
如当$a<b<c$，则$$\begin{aligned}
\int_a^cf(x)dx &= \int_a^bf(x)dx + \int_b^cf(x)dx\\
\int_a^bf(x)dx &=\int_a^cf(x)dx - \int_b^cf(x)dx = \int_a^bf(x)dx + \int_c^bf(x)dx
\end{aligned}$$

积分中值定理：
若$f(x)$在$[a,b]$上连续，则至少存在一点$\xi\in[a,b]$使得$$\int_a^bf(x)dx = f(\xi)(b-a)$$
证明：
因为$f(x)$在$[a,b]$上连续，故可积，设$f(x)$在$[a,b]$上的最大值和最小值分别是$M,m$，则$$m(b-a)\le \int_a^b f(x)dx \le M(b-a)$$
即$$m\le \frac 1 {b-a}\int_a^b f(x)dx \le M$$
由连续函数的介值定理，至少存在一点$\xi\in[a,b]$使得$$f(\xi)=\frac 1 {b-a}\int_a^b f(x)dx$$
即$$\int_a^bf(x)dx = f(\xi)(b-a)$$

当$f(x)\ge 0$时，积分中值定理的几何意义是对应曲边梯形，总存在一个长为$b-a$，高为$f(\xi)$的矩形，使得矩形等于曲边梯形的面积

## 3.2 微积分基本定理
注意本章所讲的定积分都属于黎曼积分

### 3.2.1 牛顿-莱布尼茨公式
一般地，设$f(x)$是定义在区间$I$上的函数，若存在函数$F(x)$，满足
$$F'(x) = f(x),\quad x\in I$$
则称$F(x)$是$f(x)$在区间$I$上的一个原函数

易证，若$f(x)$在区间$I$上有原函数，则一定有无穷多个，且其中任意两个原函数之间只相差一个常数
因此，若$F(x)$是$f(x)$的一个原函数，则$F(x)+c(c为任意常数)$就是$f(x)$所有原函数的一般表达式

微积分基本定理：
设$f(x)$是$[a,b]$上的可积函数，$F(x)$是$f(x)$在$[a,b]$上的一个原函数，则
$$\int_a^bf(x)dx = F(b)-F(a)=\left . F(x)\right|_a^b$$

证明：
任取$[a,b]$的一个分划$a = x_0 < x_1 < \cdots < x_{n-1} < x_n = b$，
由微分中值定理可知，存在$\xi_i \in (x_{i-1}, x_i)(i = 1, 2, \cdots , n)$，使得$$F(x_i) - F(x_{i-1}) = F'(\xi_i)(x_i - x_{i-1}) = f(\xi_i)(x_i - x_{i-1}) = f(\xi_i)\Delta x_i$$
从而
$$F(b) - F(a) = \sum_{i=1}^n[F(x_i)-F(x_{i-1})]=\sum_{i=1}^nf(\xi_i)\Delta x_i$$
显然$\sum_{i=1}^nf(\xi_i)\Delta x_i$是$f(x)$在$[a,b]$上的一个特殊积分和，由于$f(x)$可积，在上式两端取极限，有
$$F(b)-F(a) = \lim_{\lambda \to 0}[F(b)-F(a)] = \lim_{\lambda \to 0}\sum_{i=1}^nf(\xi_i)\Delta x_i = \int_a^bf(x)dx$$
该式称为牛顿-莱布尼茨公式，这个公式揭示了微分和积分之间的关系，故也称为微积分基本公式

根据微积分基本共识，我们可以方便地对定积分进行计算，把对定积分的计算归结为求原函数的问题

应用：
(1) $$\int_0^1 \frac 1 {1 + x^2} dx = \left .\arctan x \right| _0^1 = \frac \pi 4$$
(2) $$\int_0^{\frac \pi 4} \frac 1 {\cos^2 x}dx = \left . \tan x\right|_0^{\frac \pi 4} = 1$$
(3) $$\int_0^1 x^n dx = \left .\frac {x^{n+1}} {n+1} \right|_0^1 = \frac 1 {n+1}$$
(4) $$\int_0^{\frac 1 2} \frac 1 {\sqrt {1 - x^2}}dx = \left.\arcsin x\right |_0^{\frac 1 2} = \frac \pi 6$$

### 3.3.2 原函数存在定理
设$f(x)$是$[a,b]$上的可积函数，$x$为$[a,b]$上的一点，由定积分的性质可知$f(x)$在$[a,x]$上也可积，即$\int_a^x f(x)dx$存在
在$\int_a^x f(x)dx$中，$x$既表示定积分上限，又表示积分变量，由于定积分与积分变量的记号无关，故可以把积分变量改为其他符号，将$\int_a^x f(x)dx$写作$$\int_a^x f(t)dt$$如果积分上限$x$在$[a,b]$内任意变动，对于任一$x\in [a,b]$，定积分$\int_a^x f(t)dt$都有唯一确定的对应值，即定积分$\int_a^x f(x)dx$在$[a,b]$上定义了一个关于$x$的函数，将它记作$\Phi(x)$，即$$\Phi(x) = \int_a^x f(t)dt\quad(x\in[a,b])$$称该函数为积分上限函数，或称为变上限定积分

原函数存在定理：
若函数$f(x)$在$[a,b]$上连续，则$\Phi(x) = \int_a^x f(t)dt$就是$f(x)$在$[a,b]$上的一个原函数，即$$\Phi'(x) = \frac d {dx}\int_a^x f(t)dt = f(x)\quad (x\in[a,b])$$

证明：
任取$x\in (a,b)$，取充分小的$\Delta x$，使$x+\Delta x \in (a,b)$，则
$$\begin{aligned}
\Phi(x+\Delta x) - \Phi(x) &= \int_a^{x+\Delta x} f(t)dt - \int_a^x f(t)dt  \\
&=\left[\int_a^x f(t)dt + \int_x^{x+\Delta x} f(t)dt\right] - \int_a^x f(t)dt \\
&=\int_x^{x+\Delta x} f(t)dt
\end{aligned}$$
再由积分中值定理，有
$$\Phi(x+\Delta x) - \Phi(x) = f(\xi)\Delta x\quad (\xi在x与x+\Delta x之间)$$
故
$$lim_{\Delta x\to 0}\frac {\Phi(x+\Delta x)-\Phi(x)}{\Delta x}=lim_{\Delta x\to0}f(\xi) = f(x)$$
若$x=a$或$x=b$，则取$\Delta x > 0$或$\Delta x <0$，以上$\Delta x \to0$分别改为$\Delta x\to 0^+$或$\Delta x \to 0^-$，就得
$$\Phi'_+(a)=f(a)$$
$$\Phi'_-(b)=f(b)$$
这就证明了$\Phi(x)$是$f(x)$在$[a,b]$上的一个原函数

由原函数存在定理可知，连续函数必有原函数，$\Phi(x)$就是其中一个
因此，计算连续函数的积分时，可以利用牛顿-莱布尼兹公式

对于只有有限个间断点(分段连续)的可积函数，或分段表示的连续函数，计算积分时可以在每个连续区间上分别计算然后相加，而计算每个子区间上的定积分时，就可以利用牛顿-莱布尼兹公式

原函数存在定理表明，由连续函数$f(x)$确定的积分上限函数$\Phi(x) = \int_a^xf(t)dt$是可导函数，并且$\Phi(x)' = f(x)$，对$\Phi(x)$的讨论与对一般可导函数的讨论完全类似

一般地，若$u(x)$是可导函数，$f(x)$连续，则有
$$\frac d {dx}\int_a^{u(x)}f(t)dt=f[u(x)]u'(x)$$
因为
$$\frac d {dx}\int_a^{u(x)}f(t)dt=(\frac d {du}\int_a^{u}f(t)dt)\cdot\frac {du} {dx}=f(u)\frac {du}{dx}=f[u(x)]u'(x)$$

## 3.3 不定积分
### 3.3.1 不定积分的概念及性质
如果$F(x)$是$f(x)$的一个原函数，则$F(x)+c(c为任意常数)$是$f(x)$所有原函数的一般表达式，我们称$F(x)+c$为$f(x)$的不定积分，即：
函数$f(x)$在区间$I$上所有原函数的一般表达式称为$f(x)$在$I$上的不定积分，记作$\int f(x)dx$，即$$\int f(x)dx = F(x)+c$$其中$\int$称为积分符号，$f(x)$称为被积函数，$f(x)dx$称为被积表达式，$x$称为积分变量，$F(x)$是$f(x)$在区间$I$上的一个原函数

# 6 多元函数微分学及其应用
## 6.1 多元函数的基本概念
### 6.1.1 $n$维点集
空间直角坐标系的建立，使得空间中的点及向量与一个三元有序数组$(x,y,z)$形成一一对应，根据向量运算法则，可以赋予三元有序数组之间的加法、数乘等运算，我们把这种有序数组的全体称为三维空间，记作$\mathbf R^3$，称这些数组是$\mathbf R^3$中的三维点

类似地，对$n$元有序数组之间同样赋予加法、数乘等运算，由$n$元有序数组$(x_1,x_2,\cdots,x_n)$的全体所组成的集合称为$n$维空间，记作$\mathbf R^n$，称每一个$n$维数组是$\mathbf R^n$中的一个$n$维点

全体实数构成的集合$\mathbf R$或数轴上一切点构成的集合称为一维空间，记作$\mathbf R^1$，全体有序数组$(x,y)$构成的集合$\mathbf R$或$xOy$平面上一切点构成的集合称为二维空间，记作$\mathbf R^2$

讨论一元函数时，涉及到了$\mathbf R^1$中的点集、区间、邻域等概念描述变量的变化范围，讨论二元函数时，就需要用到平面点集和区域等概念

$xOy$平面上具有某种条件的点的集合，称为平面点集
例如$E = \{(x,y)| 1 < x^2 + y^2 < 4\}$

下面以$\mathbf R^2$为例，介绍$\mathbf R^n$中的一些集合
设$P_0(x_0,y_0)\in \mathbf R^n$，$\delta$是某一正数，与点$P_0$的距离小于$\delta$的点$P(x,y)$全体，称为点$P_0$的$\delta$邻域，记作$U(P_0,\delta)$，即
$$U(P_0,\delta) = \{P|\ |PP_0|<\delta\}=\{(x,y)|\ \sqrt{(x-x_0)^2+(y-y_0)^2}<\delta\}$$
若点$P_0$不包括在该邻域内，称该领域为点$P_0$的去心$\delta$领域，记作$\mathring{U}(P_0,\delta)$

设集合$E\subset \mathbf R^2$，$P\in \mathbf R^2$，如果存在$\delta > 0$，使得$U(P,\delta) \subset E$，则称$P$是$E$的内点，若$U(P,\delta) \cap E = \varnothing$，则称$P$是$E$的外点，如果点$P$的任何一个领域内既有属于$E$的点又有不属于$E$的点，则称$P$是$E$的边界点

$E$的边界点的全体，称为$E$的边界，记作$\partial E$
$E$的内点必然属于$E$，$E$的外点必然不属于$E$，而$E$的边界点可能属于也可能不属于$E$

如果对于任意给定的$\delta > 0$，点$P$的去心邻域$\mathring{U}(P,\delta)$内总有$E$的点，称$P$是$E$的聚点
点集$E$和它边界$\partial E$上的一切点都是$E$的聚点，可见聚点可以不属于该点集

聚点与维数无关，内点与维数有关，比如在一维空间中，$E = (a,b)$内的点都是$E$的内点，也是$E$的聚点，但在二维空间中，它们只是$E$的聚点，不再是内点

一些重要的平面点集
如果$E$中的点都是$E$的内点，称$E$为$\mathbf R^2$中的开集
如果$E$中的所有聚点都属于$E$，称$E$为$\mathbf R^2$中的闭集
例如$\{(x,y)|0<x<1,0<y<1\}$是开集，$\{(x,y)|0\le x\le1,0\le y\le1\}$是闭集，$\{(x,y)|0<x\le1,0<y\le1\}$既不是开集也不是闭集

如果点集$E$内的任何两点，都可以用折线连起来，且该折线上的点都属于$E$，称$E$为连通集
连通的开集称为区域或开区域
开区域连通它的边界一起构成的点集称为闭区域

对于平面点集$E$，如果存在某一正数$r$，使得$E\subset U(O,r)$，其中$O$是坐标原点，称$E$为有界集，否则称为无界集

上述概念都可以推广到$\mathbf R^n$中，对于$\mathbf R^n$中的点$M(x_1,x_2,\cdots, x_n)$和点$N(y_1,y_2,\cdots,y_n)$规定两点之间的距离
$$|MN| = \sqrt {(x_1-y_1)^2 + (x_2-y_2)^2+\cdots+(x_n-y_n)^2  }$$
### 6.1.2 多元函数的定义
设$D$是$n$维空间$\mathbf R^n$的非空子集，$\mathbf R$为实数集，如果按照某一确定的法则$f$，对$D$内每一点$P(x_1,x_2,\cdots,x_n)$，均有唯一的一个确定的实数$u\in \mathbf R$与之对应，称$f$是定义在$D$上的$n$元函数，它在点$P(x_1,x_2,\cdots,x_n)$处的函数值是$u$，记
$$u = f(x_1,x_2,\cdots,x_n)\quad (x_1,x_2,\cdots,x_n)\in D$$
或简记为
$$u = f(\symbfit x)\quad \symbfit x = (x_1,x_2,\cdots,x_n)\in D$$
也可记为
$$u = f(P)\quad P(x_1,x_2,\cdots,x_n)\in D$$
其中$x_1,x_2,\cdots, x_n$称为自变量，$u$称为因变量，$D$称为定义域，函数值$f(x_1,x_2,\cdots ,x_n)$的全体称为值域，记作$f(D)$

当$n\ge 2$时，$n$元函数统称为多元函数，多元函数概念中有两个要素：定义域和对应法则，与一元函数相同

与一元初等函数类似，可以定义多元初等函数，它指能用一个算式表示的多元函数，这个算式由不同变量的一元初等函数和常数经过有限次四则运算和复合得到
### 6.1.3 二元函数的极限
从一元函数推广到二元函数，有一些共性之处，但会出现一些实质性的差异，而从二元函数推广到三元至更多元只是形式和技巧上的差别，无本质不同

